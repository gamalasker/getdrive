<!DOCTYPE html>
<html lang="ar" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠ</title>
    <style>
        :root {
            --color-primary: #2563eb;
            --color-primary-hover: #1d4ed8;
            --color-success: #10b981;
            --color-danger: #ef4444;
            --color-warning: #f59e0b;
            --color-bg: #f8fafc;
            --color-surface: #ffffff;
            --color-text: #1e293b;
            --color-text-secondary: #64748b;
            --color-border: #e2e8f0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--color-text);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            background: var(--color-surface);
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
            text-align: center;
        }

        .header h1 {
            color: var(--color-primary);
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header .school-name {
            color: var(--color-text-secondary);
            font-size: 1.2rem;
            margin-bottom: 5px;
        }

        .header .subtitle {
            color: var(--color-text-secondary);
            font-size: 0.95rem;
        }

        .controls {
            background: var(--color-surface);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            align-items: center;
        }

        .day-tabs {
            display: flex;
            gap: 10px;
            flex: 1;
            flex-wrap: wrap;
        }

        .day-tab {
            padding: 12px 24px;
            background: #f1f5f9;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
            color: var(--color-text-secondary);
        }

        .day-tab:hover {
            background: #e2e8f0;
            transform: translateY(-2px);
        }

        .day-tab.active {
            background: var(--color-primary);
            color: white;
            border-color: var(--color-primary);
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 0.95rem;
        }

        .btn-primary {
            background: var(--color-primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--color-primary-hover);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }

        .btn-success {
            background: var(--color-success);
            color: white;
        }

        .btn-success:hover {
            background: #059669;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        }

        .btn-danger {
            background: var(--color-danger);
            color: white;
        }

        .btn-danger:hover {
            background: #dc2626;
        }

        .schedule-container {
            background: var(--color-surface);
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 3px solid var(--color-border);
        }

        .day-title {
            font-size: 1.8rem;
            color: var(--color-primary);
            font-weight: 700;
        }

        .general-supervisor {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.3);
        }

        .supervisors-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 25px;
        }

        .supervisor-card {
            background: #f8fafc;
            border: 2px solid var(--color-border);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s;
            cursor: move;
            position: relative;
        }

        .supervisor-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            border-color: var(--color-primary);
        }

        .supervisor-card.dragging {
            opacity: 0.5;
            transform: scale(0.95);
        }

        .supervisor-name {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--color-text);
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .supervisor-name::before {
            content: 'ğŸ‘¤';
            font-size: 1.4rem;
        }

        .supervisor-info {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .info-row {
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--color-text-secondary);
            font-size: 0.95rem;
        }

        .info-icon {
            font-weight: 600;
            color: var(--color-primary);
        }

        .card-actions {
            display: flex;
            gap: 8px;
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid var(--color-border);
        }

        .btn-small {
            padding: 6px 12px;
            font-size: 0.85rem;
            border-radius: 6px;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 16px;
            max-width: 500px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .modal-header {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--color-primary);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--color-border);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--color-text);
        }

        .form-input,
        .form-select {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--color-border);
            border-radius: 8px;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input:focus,
        .form-select:focus {
            outline: none;
            border-color: var(--color-primary);
            box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.1);
        }

        .modal-actions {
            display: flex;
            gap: 10px;
            margin-top: 25px;
            justify-content: flex-end;
        }

        /* Print Styles */
        @media print {
            body {
                background: white;
                padding: 0;
                font-size: 12pt;
            }

            .container,
            .header,
            .controls,
            .schedule-container {
                display: none !important;
            }

            .print-content {
                display: block !important;
                width: 100%;
                padding: 20px;
            }

            .print-header {
                text-align: center;
                margin-bottom: 30px;
                border-bottom: 2px solid #000;
                padding-bottom: 20px;
            }

            .print-header h1 {
                font-size: 24pt;
                margin-bottom: 10px;
                color: #000;
            }

            .print-header .meta-info {
                display: flex;
                justify-content: space-between;
                font-size: 14pt;
                margin-top: 20px;
                font-weight: bold;
            }

            .print-table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 20px;
            }

            .print-table th,
            .print-table td {
                border: 1px solid #000;
                padding: 10px;
                text-align: right;
            }

            .print-table th {
                background-color: #f0f0f0 !important;
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                font-weight: bold;
                font-size: 14pt;
            }

            .print-table td {
                font-size: 12pt;
            }

            .signature-col {
                width: 150px;
            }

            .print-footer {
                margin-top: 50px;
                display: flex;
                justify-content: space-between;
                padding: 0 50px;
                font-weight: bold;
                font-size: 14pt;
            }
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .controls {
                flex-direction: column;
            }

            .day-tabs {
                width: 100%;
                justify-content: center;
            }

            .supervisors-grid {
                grid-template-columns: 1fr;
            }
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: var(--color-text-secondary);
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 20px;
        }

        .stats {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 25px;
            border-radius: 10px;
            flex: 1;
            min-width: 200px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“‹ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ø´Ø±Ø§Ù Ø§Ù„Ù…Ø¯Ø±Ø³ÙŠ Ø§Ù„ÙŠÙˆÙ…ÙŠ</h1>
            <div class="school-name">Ù…Ø¯Ø±Ø³Ø© Ø¯. Ù…Ø­Ù…Ø¯ Ø±Ø¨ÙŠØ¹ ÙÙ„Ø§Ø­ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø¨Ù†Ø§Øª</div>
            <div class="subtitle">Ù†Ø¸Ø§Ù… Ø´Ø§Ù…Ù„ Ù„Ø¥Ø¯Ø§Ø±Ø© ÙˆØªÙ†Ø¸ÙŠÙ… Ø§Ù„Ø¥Ø´Ø±Ø§Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ</div>
        </div>

        <div class="controls">
            <div class="day-tabs" id="dayTabs"></div>
            <input type="date" id="printDate" class="form-input"
                style="width: auto; max-width: 150px; cursor: pointer;">
            <button class="btn btn-primary" onclick="addSupervisor()">â• Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±Ù</button>
            <button class="btn btn-primary" onclick="editGeneralSupervisor()">âœï¸ ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…</button>
            <button class="btn btn-success" onclick="window.print()">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø©</button>
            <button class="btn btn-warning" onclick="exportToWord()" style="background-color: #2b5797; color: white;">ğŸ“„
                ØªØµØ¯ÙŠØ± Ù„ÙˆÙˆØ±Ø¯</button>
        </div>

        <div class="schedule-container">
            <div class="stats" id="stats"></div>
            <div class="day-header">
                <div class="day-title" id="dayTitle"></div>
                <div class="general-supervisor" id="generalSupervisor"></div>
            </div>
            <div class="supervisors-grid" id="supervisorsGrid"></div>
        </div>
    </div>

    <!-- Print Content Container -->
    <div class="print-content" id="printContent"></div>

    <!-- Modal for Adding/Editing Supervisor -->
    <div class="modal" id="supervisorModal">
        <div class="modal-content">
            <div class="modal-header" id="modalTitle">Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±Ù Ø¬Ø¯ÙŠØ¯</div>
            <form id="supervisorForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ù„ÙŠÙˆÙ…</label>
                    <select class="form-select" id="supervisorDay" required>
                        <option value="Ø§Ù„Ø£Ø­Ø¯">Ø§Ù„Ø£Ø­Ø¯</option>
                        <option value="Ø§Ù„Ø§Ø«Ù†ÙŠÙ†">Ø§Ù„Ø§Ø«Ù†ÙŠÙ†</option>
                        <option value="Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡">Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡</option>
                        <option value="Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡">Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡</option>
                        <option value="Ø§Ù„Ø®Ù…ÙŠØ³">Ø§Ù„Ø®Ù…ÙŠØ³</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø§Ø³Ù…</label>
                    <input type="text" class="form-input" id="supervisorName" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ù…Ø¨Ù†Ù‰</label>
                    <select class="form-select" id="supervisorBuilding" required>
                        <option value="Ø§Ù„Ø¬Ø¯ÙŠØ¯">Ø§Ù„Ø¬Ø¯ÙŠØ¯</option>
                        <option value="Ø§Ù„Ù‚Ø¯ÙŠÙ…">Ø§Ù„Ù‚Ø¯ÙŠÙ…</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Ø§Ù„Ø¯ÙˆØ±</label>
                    <select class="form-select" id="supervisorFloor" required>
                        <option value="Ø§Ù„Ø£ÙˆÙ„">Ø§Ù„Ø£ÙˆÙ„</option>
                        <option value="Ø§Ù„Ø«Ø§Ù†ÙŠ">Ø§Ù„Ø«Ø§Ù†ÙŠ</option>
                        <option value="Ø§Ù„Ø«Ø§Ù„Ø«">Ø§Ù„Ø«Ø§Ù„Ø«</option>
                        <option value="Ø§Ù„Ø±Ø§Ø¨Ø¹">Ø§Ù„Ø±Ø§Ø¨Ø¹</option>
                        <option value="Ø§Ù„Ø®Ø§Ù…Ø³">Ø§Ù„Ø®Ø§Ù…Ø³</option>
                    </select>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-danger" onclick="closeModal()">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-success">Ø­ÙØ¸</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal for Editing General Supervisor -->
    <div class="modal" id="generalSupervisorModal">
        <div class="modal-content">
            <div class="modal-header">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…</div>
            <form id="generalSupervisorForm">
                <div class="form-group">
                    <label class="form-label">Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…</label>
                    <input type="text" class="form-input" id="generalSupervisorName" required>
                </div>
                <div class="modal-actions">
                    <button type="button" class="btn btn-danger" onclick="closeGeneralModal()">Ø¥Ù„ØºØ§Ø¡</button>
                    <button type="submit" class="btn btn-success">Ø­ÙØ¸</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Initial data
        let scheduleData = {
            'Ø§Ù„Ø£Ø­Ø¯': {
                'general_supervisor': 'ÙØªØ­ÙŠ Ø¹ÙŠØ¯',
                'supervisors': [
                    { 'name': 'Ø¹Ø§Ø·Ù ÙƒØ§Ù…Ù„', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ù†Ø¨ÙŠÙ„Ø© ÙØ¤Ø§Ø¯ Ø­Ø³Ù†', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ø¨Ø³Ù…Ø© Ø§Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø­Ø³Ø§Ù… Ù…Ù†ØµÙˆØ±', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø´ÙŠÙ…Ø§Ø¡ Ø¬Ù„Ø§Ù„', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø®Ø§Ù…Ø³' },
                    { 'name': 'Ø³Ø­Ø± Ø£Ù†ÙˆØ±', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'ÙŠØ³Ø±Ø§ Ø¬Ù…Ø§Ù„', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'ØµØ¨Ø§Ø­ Ø§Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø³Ù†Ø§Ø¡ Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø¹Ù„Ù‰ Ø§Ù…Ø§Ù…', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø³Ø¹ÙŠØ¯ Ø±Ù…Ø¶Ø§Ù†', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' }
                ]
            },
            'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†': {
                'general_supervisor': 'Ù†Ø§ØµØ± Ø¹Ø¨Ø¯ Ø§Ù„Ø­Ù…ÙŠØ¯',
                'supervisors': [
                    { 'name': 'Ø¹Ø§Ø¯Ù„ Ø§Ù„Ø³Ù†Ø¨Ø§Ø·ÙŠ', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø§ÙŠÙ…Ø§Ù† Ø§Ø¨Ùˆ Ø§Ù„ÙØªÙˆØ­', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ù…Ù‡Ø¯Ù‰ Ø¹Ø¨Ø¯ Ø§Ù„ÙØªØ§Ø­', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø§Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø­Ù…ÙŠØ¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ù…Ø­Ù…Ø¯ Ø¹Ø³Ø§ÙƒØ± Ø§Ù„Ù…Ø³Ù„Ù…Ù‰', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø®Ø§Ù…Ø³' },
                    { 'name': 'ÙŠØ³Ø±Ø§ Ø¬Ù…Ø§Ù„', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ù„ÙŠÙ„Ù‰ Ø¹Ù„Ù‰', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'ØµÙØ§Ø¡ Ù…Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ù…Ø§Ù‡Ø± Ø¹Ø¨Ø¯ Ø§Ù„Ø­Ù„ÙŠÙ…', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø§Ø­Ù…Ø¯ ÙØ±Ø§Ø¬ Ø§Ù„Ù‡Ø§Ø¯Ù‰', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø­Ø§ÙØ¸Ù‡ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø¸ÙŠÙ…', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' }
                ]
            },
            'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡': {
                'general_supervisor': 'Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø±Ù…Ø¶Ø§Ù† Ø¨ÙƒØ±',
                'supervisors': [
                    { 'name': 'Ø§Ù†Ø¹Ø§Ù… ØµÙ„Ø§Ø­', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø±ÙŠÙ‡Ø§Ù… Ø´ÙˆÙ‚', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø§Ø³Ø±Ø§Ø¡ Ø§Ø­Ù…Ø¯ ØµØ¯ÙŠÙ‚', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ø¯ÙŠÙ†Ø§ Ø­Ù…Ø§Ø¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø±Ø´Ø§ Ø±Ù…Ø¶Ø§Ù† Ø­Ø§Ù…Ø¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø·Ù„Ø¹Øª Ø¹Ø¨Ø¯ Ø§Ù„Ù…Ø¹Ø¨ÙˆØ¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø®Ø§Ù…Ø³' },
                    { 'name': 'Ù†Ø¨ÙŠÙ„Ø© ÙØ¤Ø§Ø¯ Ø­Ø³Ù†', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ù…Ù†Ø§Ù„ Ø¹Ø¨Ø¯ Ø§Ù„Ø³ØªØ§Ø±', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø­Ù†Ø§Ù† Ø³Ù„ÙŠÙ…', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø£Ù…Ø§Ù†ÙŠ Ù…ÙˆØ³ÙŠ', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ù‡Ù†Ø§Ø¡ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„ÙØªØ§Ø­', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ù„Ø¨Ù†Ù‰ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø²ÙŠØ²', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø³Ø­Ø± Ø§Ù„Ø´Ø­Ø§Øª', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„ÙˆÙ‡Ø§Ø¨', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø­Ø§ÙØ¸Ù‡ Ø¹Ø¨Ø¯ Ø§Ù„Ø¹Ø¸ÙŠÙ…', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' }
                ]
            },
            'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡': {
                'general_supervisor': 'Ø¹Ø¨Ø¯ Ø§Ù„Ø³Ù„Ø§Ù… Ø¬Ù…Ø§Ù„',
                'supervisors': [
                    { 'name': 'Ù‡Ø¯Ù‰ Ø·Ù†Ø·Ø§ÙˆÙŠ', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø¹Ø§ÙŠØ¯Ù‡ Ù†ÙˆØ±', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø¹Ø¨ÙŠØ± Ø¹Ø¨Ø¯ Ø§Ù„Ù„Ù‡', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ø²Ø¨ÙŠØ¯Ø© Ù…Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'ÙˆÙ‡ÙŠØ¨Ù‡ Ø§Ù„Ø³ÙŠØ¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø¯ÙŠÙ†Ø§ Ø­Ù…Ø§Ø¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø®Ø§Ù…Ø³' },
                    { 'name': 'Ø§Ù„Ù…Ø³Ù„Ù…Ù‰', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø³Ø¹ÙŠØ¯ Ø§Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø¹Ø¨ÙŠØ± Ø§Ù„Ø³ÙŠØ¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ù‡Ø¯Ù‰ Ø¬Ù…Ø¹Ù‡', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'ÙˆÙØ§Ø¡ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„Ø´Ø§ÙÙŠ', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø³Ù†Ø¯Ø³ÙŠÙ‡', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø§Ø­Ù…Ø¯ Ø³ÙŠØ¯ Ø§Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø§ÙŠÙ‡ Ø§Ø¨Ø±Ø§Ù‡ÙŠÙ… ØµØ§Ø¯Ù‚', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø¹Ø¨Ø¯ Ø§Ù„Ù…ØµÙ„Ø­', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø¹Ù„Ø§Ø¡ Ø³ÙŠØ¯ Ø£Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' }
                ]
            },
            'Ø§Ù„Ø®Ù…ÙŠØ³': {
                'general_supervisor': 'Ù…Ø­Ù…Ø¯ Ø¥Ø¨Ø±Ø§Ù‡ÙŠÙ… Ø§Ù„Ø¯Ø³ÙˆÙ‚Ù‰',
                'supervisors': [
                    { 'name': 'Ø¹Ø¨ÙŠØ± Ø±Ù…Ø¶Ø§Ù†', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø§ÙŠÙ…Ø§Ù† Ø§Ø¨Ùˆ Ø§Ù„ÙØªÙˆØ­', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø§Ø³Ø±Ø§Ø¡ Ø§Ø­Ù…Ø¯ ØµØ¯ÙŠÙ‚', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø§ÙŠÙ†Ø§Ø³ Ø¹Ø¨Ø¯ Ø§Ù„ÙˆÙ‡Ø§Ø¨', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ø£ÙŠÙ…Ù† Ø¹Ø·ÙŠØ© Ø­Ø¨ÙŠØ¨', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'ÙˆÙ‡ÙŠØ¨Ù‡ Ø§Ù„Ø³ÙŠØ¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'ÙˆÙ„ÙŠØ¯ Ù…Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ø¬Ø¯ÙŠØ¯', 'floor': 'Ø§Ù„Ø®Ø§Ù…Ø³' },
                    { 'name': 'Ø¹Ø§ÙŠØ¯Ù‡ Ù†ÙˆØ±', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ø¹Ø¨ÙŠØ± Ø§Ù„Ø³ÙŠØ¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø£ÙˆÙ„' },
                    { 'name': 'Ù†Ø§Ù‡Ø¯ Ø¹Ø¨Ø¯ Ø§Ù„ÙˆÙ‡Ø§Ø¨', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù†ÙŠ' },
                    { 'name': 'Ø³Ø­Ø± Ø§Ù„Ø´Ø­Ø§Øª', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø¹ÙØª Ø¹Ù„Ù‰ Ù…Ø­Ù…Ø¯', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø¹Ù„Ù‰ ØµØ§Ø¨Ø±', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø«Ø§Ù„Ø«' },
                    { 'name': 'Ø¹Ø¨ÙŠØ± Ø§Ù„Ø³Ø¹ÙŠØ¯ ÙƒØ§Ù…Ù„', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' },
                    { 'name': 'Ø±Ù…Ø¶Ø§Ù† Ø¹Ø¨Ø¯ Ø§Ù„Ø±Ø§Ø²Ù‚', 'building': 'Ø§Ù„Ù‚Ø¯ÙŠÙ…', 'floor': 'Ø§Ù„Ø±Ø§Ø¨Ø¹' }
                ]
            }
        };

        let currentDay = 'Ø§Ù„Ø£Ø­Ø¯';
        let editingIndex = -1;
        let draggedElement = null;
        let draggedIndex = -1;

        // Helper function to get full date
        function getFullDate() {
            const dateInput = document.getElementById('printDate');
            const selectedDate = dateInput.valueAsDate || new Date();
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
            return selectedDate.toLocaleDateString('ar-EG', options);
        }

        // Get selected day name
        function getSelectedDayName() {
            const dateInput = document.getElementById('printDate');
            const selectedDate = dateInput.valueAsDate || new Date();
            return selectedDate.toLocaleDateString('ar-EG', { weekday: 'long' });
        }

        // Load data from localStorage if exists
        function loadData() {
            const saved = localStorage.getItem('supervisionSchedule');
            if (saved) {
                scheduleData = JSON.parse(saved);
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('supervisionSchedule', JSON.stringify(scheduleData));
        }

        // Initialize
        function init() {
            loadData();
            // Set date input to today
            document.getElementById('printDate').valueAsDate = new Date();
            renderDayTabs();
            renderSchedule();
        }

        // Render day tabs
        function renderDayTabs() {
            const days = ['Ø§Ù„Ø£Ø­Ø¯', 'Ø§Ù„Ø§Ø«Ù†ÙŠÙ†', 'Ø§Ù„Ø«Ù„Ø§Ø«Ø§Ø¡', 'Ø§Ù„Ø£Ø±Ø¨Ø¹Ø§Ø¡', 'Ø§Ù„Ø®Ù…ÙŠØ³'];
            const tabsContainer = document.getElementById('dayTabs');
            tabsContainer.innerHTML = days.map(day =>
                `<div class="day-tab ${day === currentDay ? 'active' : ''}" onclick="switchDay('${day}')">${day}</div>`
            ).join('');
        }

        // Switch day
        function switchDay(day) {
            currentDay = day;
            renderDayTabs();
            renderSchedule();
        }

        // Render schedule
        function renderSchedule() {
            const data = scheduleData[currentDay];
            document.getElementById('dayTitle').textContent = `Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø´Ø±Ø§Ù - ${currentDay}`;
            document.getElementById('generalSupervisor').innerHTML = `ğŸ‘¨â€ğŸ’¼ Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…: ${data.general_supervisor}`;

            // Render stats
            const statsHtml = `
                <div class="stat-card">
                    <div class="stat-value">${data.supervisors.length}</div>
                    <div class="stat-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø´Ø±ÙÙŠÙ†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${data.supervisors.filter(s => s.building === 'Ø§Ù„Ø¬Ø¯ÙŠØ¯').length}</div>
                    <div class="stat-label">Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ø¬Ø¯ÙŠØ¯</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value">${data.supervisors.filter(s => s.building === 'Ø§Ù„Ù‚Ø¯ÙŠÙ…').length}</div>
                    <div class="stat-label">Ø§Ù„Ù…Ø¨Ù†Ù‰ Ø§Ù„Ù‚Ø¯ÙŠÙ…</div>
                </div>
            `;
            document.getElementById('stats').innerHTML = statsHtml;

            // Render supervisors
            const grid = document.getElementById('supervisorsGrid');
            if (data.supervisors.length === 0) {
                grid.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-state-icon">ğŸ“‹</div>
                        <h3>Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø´Ø±ÙÙŠÙ†</h3>
                        <p>Ø§Ø¶ØºØ· Ø¹Ù„Ù‰ "Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±Ù" Ù„Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±Ù Ø¬Ø¯ÙŠØ¯</p>
                    </div>
                `;
                return;
            }

            grid.innerHTML = data.supervisors.map((supervisor, index) => `
                <div class="supervisor-card" draggable="true" 
                     ondragstart="handleDragStart(event, ${index})"
                     ondragover="handleDragOver(event)"
                     ondrop="handleDrop(event, ${index})"
                     ondragend="handleDragEnd(event)">
                    <div class="supervisor-name">${supervisor.name}</div>
                    <div class="supervisor-info">
                        <div class="info-row">
                            <span class="info-icon">ğŸ¢</span>
                            <span>Ø§Ù„Ù…Ø¨Ù†Ù‰: ${supervisor.building}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-icon">ğŸ“</span>
                            <span>Ø§Ù„Ø¯ÙˆØ±: ${supervisor.floor}</span>
                        </div>
                        <div class="info-row">
                            <span class="info-icon">ğŸ“‹</span>
                            <span>Ø§Ù„Ù…ÙˆÙ‚Ø¹: ${supervisor.building} - ${supervisor.floor}</span>
                        </div>
                    </div>
                    <div class="card-actions">
                        <button class="btn btn-primary btn-small" onclick="editSupervisor(${index})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
                        <button class="btn btn-danger btn-small" onclick="deleteSupervisor(${index})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
                    </div>
                </div>
            `).join('');

            // Render Print Content
            const printContent = document.getElementById('printContent');

            // Use currentDay (Active Tab) as the source of truth for the schedule data and day name
            // The date picker provides the date string only.
            const printData = scheduleData[currentDay];

            printContent.innerHTML = `
                <div class="print-header">
                    <h1>Ù…Ø¯Ø±Ø³Ø© Ø¯. Ù…Ø­Ù…Ø¯ Ø±Ø¨ÙŠØ¹ ÙÙ„Ø§Ø­ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø¨Ù†Ø§Øª</h1>
                    <h2>ÙƒØ´Ù ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø±Ø§Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
                    <div class="meta-info">
                        <div>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${getFullDate()}</div>
                        <div>Ø§Ù„ÙŠÙˆÙ…: ${currentDay}</div>
                        <div>Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…: ${printData.general_supervisor}</div>
                    </div>
                </div>

                <table class="print-table">
                    <thead>
                        <tr>
                            <th style="width: 50px">Ù…</th>
                            <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±Ù</th>
                            <th>Ø§Ù„Ù…Ø¨Ù†Ù‰</th>
                            <th>Ø§Ù„Ø¯ÙˆØ±</th>
                            <th>Ø§Ù„ØªÙˆØ§Ø¬Ø¯</th>
                            <th class="signature-col">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${printData.supervisors.map((supervisor, index) => `
                        <tr>
                            <td>${index + 1}</td>
                            <td>${supervisor.name}</td>
                            <td>${supervisor.building}</td>
                            <td>${supervisor.floor}</td>
                            <td>${supervisor.building} - ${supervisor.floor}</td>
                            <td></td>
                        </tr>
                        `).join('')}
                    </tbody>
                </table>

                <div class="print-footer">
                    <div>ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…</div>
                    <div>Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
                </div>
            `;
        }

        // Export to Word
        function exportToWord() {
            // Use currentDay (Active Tab) to ensure export matches screen
            const data = scheduleData[currentDay];
            const dateStr = getFullDate();

            const header = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40' dir='rtl'>
                <head>
                    <meta charset='utf-8'>
                    <title>Ø¬Ø¯ÙˆÙ„ Ø§Ù„Ø¥Ø´Ø±Ø§Ù</title>
                    <style>
                        body { font-family: 'Arial', sans-serif; direction: rtl; text-align: right; }
                        table { width: 100%; border-collapse: collapse; margin-top: 20px; direction: rtl; }
                        td, th { border: 1px solid black; padding: 8px; text-align: right; }
                        th { background-color: #f2f2f2; }
                        .header { text-align: center; margin-bottom: 20px; }
                        h1 { font-size: 24pt; margin: 0; }
                        h2 { font-size: 18pt; margin: 10px 0; }
                        .meta { margin-top: 15px; font-size: 14pt; font-weight: bold; }
                    </style>
                </head>
                <body>
                    <div class="header">
                        <h1>Ù…Ø¯Ø±Ø³Ø© Ø¯. Ù…Ø­Ù…Ø¯ Ø±Ø¨ÙŠØ¹ ÙÙ„Ø§Ø­ Ø§Ù„Ø«Ø§Ù†ÙˆÙŠØ© Ø¨Ù†Ø§Øª</h1>
                        <h2>ÙƒØ´Ù ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ø¥Ø´Ø±Ø§Ù Ø§Ù„ÙŠÙˆÙ…ÙŠ</h2>
                        <div class="meta">
                            <p>Ø§Ù„ØªØ§Ø±ÙŠØ®: ${dateStr}</p>
                            <p>Ø§Ù„ÙŠÙˆÙ…: ${currentDay}</p>
                            <p>Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…: ${data.general_supervisor}</p>
                        </div>
                    </div>
                    
                    <table dir="rtl" style="width: 100%; table-layout: fixed;">
                        <thead>
                            <tr>
                                <th style="width: 50px">Ù…</th>
                                <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±Ù</th>
                                <th>Ø§Ù„Ù…Ø¨Ù†Ù‰</th>
                                <th>Ø§Ù„Ø¯ÙˆØ±</th>
                                <th>Ø§Ù„ØªÙˆØ§Ø¬Ø¯</th>
                                <th style="width: 150px">Ø§Ù„ØªÙˆÙ‚ÙŠØ¹</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${data.supervisors.map((supervisor, index) => `
                            <tr>
                                <td>${index + 1}</td>
                                <td>${supervisor.name}</td>
                                <td>${supervisor.building}</td>
                                <td>${supervisor.floor}</td>
                                <td>${supervisor.building} - ${supervisor.floor}</td>
                                <td></td>
                            </tr>
                            `).join('')}
                        </tbody>
                    </table>

                    <div style="margin-top: 50px; display: flex; justify-content: space-between; padding: 0 50px; font-weight: bold; font-size: 14pt;">
                        <div style="float: right;">ØªÙˆÙ‚ÙŠØ¹ Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…</div>
                        <div style="float: left;">Ù…Ø¯ÙŠØ± Ø§Ù„Ù…Ø¯Ø±Ø³Ø©</div>
                    </div>
                </body>
                </html>
            `;

            const blob = new Blob(['\ufeff', header], {
                type: 'application/msword'
            });

            // Create download link
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `Ø¬Ø¯ÙˆÙ„_Ø§Ù„Ø§Ø´Ø±Ø§Ù_${currentDay}_${new Date().toISOString().split('T')[0]}.doc`;

            document.body.appendChild(link);
            link.click();

            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        // Drag and drop handlers
        function handleDragStart(event, index) {
            draggedElement = event.target;
            draggedIndex = index;
            event.target.classList.add('dragging');
        }

        function handleDragOver(event) {
            event.preventDefault();
        }

        function handleDrop(event, targetIndex) {
            event.preventDefault();
            if (draggedIndex !== targetIndex) {
                const data = scheduleData[currentDay];
                const draggedItem = data.supervisors[draggedIndex];
                data.supervisors.splice(draggedIndex, 1);
                data.supervisors.splice(targetIndex, 0, draggedItem);
                saveData();
                renderSchedule();
            }
        }

        function handleDragEnd(event) {
            event.target.classList.remove('dragging');
        }

        // Add supervisor
        function addSupervisor() {
            editingIndex = -1;
            document.getElementById('modalTitle').textContent = 'Ø¥Ø¶Ø§ÙØ© Ù…Ø´Ø±Ù Ø¬Ø¯ÙŠØ¯';
            document.getElementById('supervisorName').value = '';
            document.getElementById('supervisorDay').value = currentDay;
            document.getElementById('supervisorBuilding').value = 'Ø§Ù„Ø¬Ø¯ÙŠØ¯';
            document.getElementById('supervisorFloor').value = 'Ø§Ù„Ø£ÙˆÙ„';
            document.getElementById('supervisorModal').classList.add('active');
        }

        // Edit supervisor
        function editSupervisor(index) {
            editingIndex = index;
            const supervisor = scheduleData[currentDay].supervisors[index];
            document.getElementById('modalTitle').textContent = 'ØªØ¹Ø¯ÙŠÙ„ Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±Ù';
            document.getElementById('supervisorName').value = supervisor.name;
            document.getElementById('supervisorDay').value = currentDay;
            document.getElementById('supervisorBuilding').value = supervisor.building;
            document.getElementById('supervisorFloor').value = supervisor.floor;
            document.getElementById('supervisorModal').classList.add('active');
        }

        // Delete supervisor
        function deleteSupervisor(index) {
            if (confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø­Ø°Ù Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙØŸ')) {
                scheduleData[currentDay].supervisors.splice(index, 1);
                saveData();
                renderSchedule();
            }
        }

        // Edit general supervisor
        function editGeneralSupervisor() {
            document.getElementById('generalSupervisorName').value = scheduleData[currentDay].general_supervisor;
            document.getElementById('generalSupervisorModal').classList.add('active');
        }

        // Close modals
        function closeModal() {
            document.getElementById('supervisorModal').classList.remove('active');
        }

        function closeGeneralModal() {
            document.getElementById('generalSupervisorModal').classList.remove('active');
        }

        // Handle supervisor form submit
        document.getElementById('supervisorForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const name = document.getElementById('supervisorName').value.trim();
            const building = document.getElementById('supervisorBuilding').value;
            const floor = document.getElementById('supervisorFloor').value;
            const selectedDay = document.getElementById('supervisorDay').value;

            if (!name) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±Ù');
                return;
            }

            const supervisor = { name, building, floor };

            // Logic to handle changing days or editing within same day
            if (editingIndex === -1) {
                // Adding new supervisor
                scheduleData[selectedDay].supervisors.push(supervisor);
            } else {
                // Editing existing supervisor
                if (selectedDay === currentDay) {
                    // Same day update
                    scheduleData[currentDay].supervisors[editingIndex] = supervisor;
                } else {
                    // Moving to different day
                    // 1. Remove from current day
                    scheduleData[currentDay].supervisors.splice(editingIndex, 1);
                    // 2. Add to new day
                    scheduleData[selectedDay].supervisors.push(supervisor);
                }
            }

            saveData();

            // If we moved the supervisor to another day, or added to another day, we might want to stay on current day or switch?
            // User requested ability to modify day. 
            // If I move a supervisor to Sunday while viewing Monday, they should disappear from Monday.
            // So simply re-rendering the current schedule is correct. 
            // If they stayed on current day, they update in place.
            // If they moved, they disappear.

            renderSchedule();
            closeModal();
        });

        // Handle general supervisor form submit
        document.getElementById('generalSupervisorForm').addEventListener('submit', function (e) {
            e.preventDefault();
            const name = document.getElementById('generalSupervisorName').value.trim();

            if (!name) {
                alert('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…');
                return;
            }

            scheduleData[currentDay].general_supervisor = name;
            saveData();
            renderSchedule();
            closeGeneralModal();
        });

        // Close modals on outside click
        document.getElementById('supervisorModal').addEventListener('click', function (e) {
            if (e.target === this) closeModal();
        });

        document.getElementById('generalSupervisorModal').addEventListener('click', function (e) {
            if (e.target === this) closeGeneralModal();
        });

        // Initialize on page load
        init();
    </script>
</body>

</html>