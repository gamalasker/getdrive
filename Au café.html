<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø§Ù„Ø¯Ø±Ø³ 1: ÙÙŠ Ø§Ù„Ù…Ù‚Ù‡Ù‰ - Au cafÃ©</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Cairo', sans-serif;
        }
        .rtl-text {
            text-align: right;
        }
        .ltr-text {
            text-align: left;
            direction: ltr;
        }
        .translation {
            transition: max-height 0.5s ease-out, opacity 0.5s ease-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        .translation.visible {
            max-height: 100px; /* Adjust as needed */
            opacity: 1;
        }
        .quiz-feedback {
            display: none;
            padding: 8px 12px;
            border-radius: 8px;
            margin-top: 10px;
            font-weight: 600;
        }
        .quiz-feedback.correct {
            background-color: #d1fae5;
            color: #065f46;
        }
        .quiz-feedback.incorrect {
            background-color: #fee2e2;
            color: #991b1b;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">

    <div class="container mx-auto p-4 sm:p-6 md:p-8 max-w-4xl">
        <!-- Header -->
        <header class="bg-white rounded-xl shadow-lg p-6 mb-8 text-center">
            <h1 class="text-3xl md:text-4xl font-bold text-indigo-700">Ø³Ù„Ø³Ù„Ø© ØªØ¹Ù„Ù… Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©: Ø§Ù„Ø¯Ø±Ø³ 1</h1>
            <h2 class="text-2xl md:text-3xl font-semibold text-gray-600 mt-2">ÙÙŠ Ø§Ù„Ù…Ù‚Ù‡Ù‰ (Au cafÃ©)</h2>
            <p class="mt-4 text-lg bg-indigo-50 text-indigo-800 p-3 rounded-lg">
                <span class="font-bold">ğŸ¯ Ø§Ù„Ù‡Ø¯Ù Ø§Ù„Ù„ØºÙˆÙŠ:</span> Ø§Ù„ØªØ­ÙŠØ© Ø§Ù„Ù…Ù‡Ø°Ø¨Ø©ØŒ ØµÙŠØºØ© Ø§Ù„Ø·Ù„Ø¨ØŒ Ø³Ø¤Ø§Ù„ Ø§Ù„ØªÙØ¶ÙŠÙ„ØŒ Ø§Ù„Ø´ÙƒØ±ØŒ ÙˆØ§Ù„Ø¯ÙØ¹ Ø¨Ù…ÙØ±Ø¯Ø§Øª Ø¨Ø³ÙŠØ·Ø©.
            </p>
        </header>

        <!-- Main Content -->
        <div class="space-y-8">

            <!-- Dialogue Section -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-2xl font-bold text-indigo-600">ğŸ’¬ Ø§Ù„Ø­ÙˆØ§Ø± Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ (Le dialogue)</h3>
                    <button id="toggle-translation-btn" class="bg-indigo-500 text-white font-semibold py-2 px-4 rounded-lg hover:bg-indigo-600 transition-colors">Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø©</button>
                </div>
                <div id="dialogue-container" class="space-y-4">
                    <!-- Dialogue lines will be injected here by JavaScript -->
                </div>
            </div>

            <!-- Vocabulary Section -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-2xl font-bold text-indigo-600 mb-4">ğŸ”‘ Ù…ÙØ±Ø¯Ø§Øª Ø³Ø±ÙŠØ¹Ø© (Vocabulaire rapide)</h3>
                <ul class="grid grid-cols-2 sm:grid-cols-3 gap-4 text-lg">
                    <li class="bg-gray-50 p-3 rounded-lg"><strong class="ltr-text block">un cafÃ©:</strong> Ù‚Ù‡ÙˆØ©</li>
                    <li class="bg-gray-50 p-3 rounded-lg"><strong class="ltr-text block">avec / sans sucre:</strong> Ù…Ø¹ / Ø¨Ø¯ÙˆÙ† Ø³ÙƒØ±</li>
                    <li class="bg-gray-50 p-3 rounded-lg"><strong class="ltr-text block">petit / grand:</strong> ØµØºÙŠØ± / ÙƒØ¨ÙŠØ±</li>
                    <li class="bg-gray-50 p-3 rounded-lg"><strong class="ltr-text block">Ã  emporter / sur place:</strong> Ø³ÙØ±ÙŠ / Ù‡Ù†Ø§</li>
                    <li class="bg-gray-50 p-3 rounded-lg"><strong class="ltr-text block">Ã‡a fait...:</strong> Ø§Ù„Ø³Ø¹Ø± Ù‡Ùˆ...</li>
                    <li class="bg-gray-50 p-3 rounded-lg"><strong class="ltr-text block">merci:</strong> Ø´ÙƒØ±Ù‹Ø§</li>
                </ul>
            </div>

            <!-- Use it Now Section -->
            <div class="bg-indigo-50 border-r-4 border-indigo-500 rounded-lg p-6">
                <h3 class="text-2xl font-bold text-indigo-600 mb-4">ğŸš€ Ø§Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ø§Ù„Ø¢Ù† (Utilisez-le maintenant)</h3>
                <div class="space-y-4 text-lg">
                    <div>
                        <p class="font-semibold ltr-text">1. Je voudrais ..., sâ€™il vous plaÃ®t.</p>
                        <p class="rtl-text pr-4 text-gray-600"><span class="font-bold">Ù…Ø«Ø§Ù„:</span> Je voudrais un thÃ©, sâ€™il vous plaÃ®t. (Ø£ÙˆØ¯ Ø´Ø§ÙŠÙ‹Ø§ Ù…Ù† ÙØ¶Ù„Ùƒ).</p>
                    </div>
                    <div>
                        <p class="font-semibold ltr-text">2. ... avec / sans ...</p>
                        <p class="rtl-text pr-4 text-gray-600"><span class="font-bold">Ù…Ø«Ø§Ù„:</span> Un jus sans sucre. (Ø¹ØµÙŠØ± Ø¨Ø¯ÙˆÙ† Ø³ÙƒØ±).</p>
                    </div>
                     <div>
                        <p class="font-semibold ltr-text">3. Petit ou grand? â†’ RÃ©ponse: ..., sâ€™il vous plaÃ®t.</p>
                        <p class="rtl-text pr-4 text-gray-600"><span class="font-bold">Ù…Ø«Ø§Ù„:</span> Grand, sâ€™il vous plaÃ®t. (ÙƒØ¨ÙŠØ±ØŒ Ù…Ù† ÙØ¶Ù„Ùƒ).</p>
                    </div>
                </div>
            </div>

            <!-- Quiz Section -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-2xl font-bold text-indigo-600 mb-6">â±ï¸ ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© Ø§Ù„ÙˆØ§Ø­Ø¯Ø© (Exercice d'une minute)</h3>
                <div class="space-y-8">
                    <!-- Quiz 1: Multiple Choice -->
                    <div>
                        <p class="text-lg font-semibold mb-3">1. Ù…Ø§ Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø£Ù†Ø³Ø¨ Ù„Ø·Ù„Ø¨ Ù‚Ù‡ÙˆØ© Ø¯ÙˆÙ† Ø³ÙƒØ±ØŸ</p>
                        <div id="mcq-quiz" class="space-y-2 text-lg">
                            <label class="flex items-center p-3 rounded-lg border hover:bg-gray-50 cursor-pointer"><input type="radio" name="mcq" value="a" class="ml-3"> <span class="ltr-text">Je voudrais un cafÃ© avec sucre.</span></label>
                            <label class="flex items-center p-3 rounded-lg border hover:bg-gray-50 cursor-pointer"><input type="radio" name="mcq" value="b" class="ml-3"> <span class="ltr-text">Je voudrais un cafÃ© sans sucre, sâ€™il vous plaÃ®t.</span></label>
                            <label class="flex items-center p-3 rounded-lg border hover:bg-gray-50 cursor-pointer"><input type="radio" name="mcq" value="c" class="ml-3"> <span class="ltr-text">Je suis un cafÃ©, merci.</span></label>
                        </div>
                        <div id="mcq-feedback" class="quiz-feedback"></div>
                    </div>
                    <!-- Quiz 2: Sentence Scramble -->
                    <div>
                        <p class="text-lg font-semibold mb-3">2. Ø±ØªÙ‘Ø¨ Ø§Ù„ÙƒÙ„Ù…Ø§Øª Ù„ØªÙƒÙˆÙŠÙ† Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©:</p>
                        <div class="bg-gray-100 p-3 rounded-lg ltr-text text-center text-xl font-mono mb-3">sâ€™il vous plaÃ®t / un cafÃ© / je voudrais</div>
                        <div class="flex flex-col sm:flex-row gap-2">
                             <input type="text" id="scramble-input" class="flex-grow p-3 border-2 border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 ltr-text" placeholder="Ø§ÙƒØªØ¨ Ø§Ù„Ø¬Ù…Ù„Ø© Ù‡Ù†Ø§...">
                            <button id="scramble-check-btn" class="bg-indigo-500 text-white font-semibold py-2 px-6 rounded-lg hover:bg-indigo-600 transition-colors">ØªØ­Ù‚Ù‚</button>
                        </div>
                        <div id="scramble-feedback" class="quiz-feedback"></div>
                    </div>
                </div>
            </div>

            <!-- Pronunciation Section -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                 <h3 class="text-2xl font-bold text-indigo-600 mb-4">ğŸ—£ï¸ ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ø·Ù‚ ÙˆØ§Ù„Ø¥ÙŠÙ‚Ø§Ø¹</h3>
                 <div class="space-y-4">
                    <p class="text-lg"><strong class="text-indigo-700">ØªØ¯Ø±ÙŠØ¨ ØµÙˆØªÙŠ:</strong> Ø±ÙƒÙ‘Ø² Ø¹Ù„Ù‰ ØµÙˆØª Ø­Ø±Ù "R" ÙÙŠ ÙƒÙ„Ù…ØªÙŠ "g**r**and" Ùˆ "su**r**". Ø­Ø§ÙˆÙ„ Ø¥Ø®Ø±Ø§Ø¬ Ø§Ù„Ù‡ÙˆØ§Ø¡ Ù…Ù† Ø§Ù„Ø­Ù„Ù‚ Ø¨Ø±ÙÙ‚. Ø±Ø¯Ù‘Ø¯ 5 Ù…Ø±Ø§Øª: "sur â€” grand â€” sur place".</p>
                    <p class="text-lg"><strong class="text-indigo-700">ØªØ¯Ø±ÙŠØ¨ Ø¥ÙŠÙ‚Ø§Ø¹ÙŠ:</strong> Ø§Ù‚Ø±Ø£ Ø§Ù„Ø¬Ù…Ù„Ø© Ø¨Ù†ØºÙ…Ø© ØµÙˆØª ØµØ§Ø¹Ø¯Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø·Ù„Ø¨ØŒ Ø«Ù… Ù†ØºÙ…Ø© Ù‡Ø§Ø¨Ø·Ø© Ø¹Ù†Ø¯ Ø§Ù„Ø´ÙƒØ±: "Je voudrais un cafÃ©, sâ€™il vous plaÃ®t â¤´ï¸. Merci â¤µï¸."</p>
                 </div>
            </div>

            <!-- Call to action & Next lessons -->
            <footer class="text-center space-y-6 pt-8">
                <div class="bg-indigo-600 text-white rounded-xl shadow-lg p-6">
                    <h3 class="text-2xl font-bold mb-3">âœ¨ Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©</h3>
                    <p class="text-lg">Ø§Ø­ÙØ¸ Ø§Ù„Ø¬Ù…Ù„ ÙÙŠ Ù‚Ø³Ù… "Ø§Ø³ØªØ®Ø¯Ù…Ù‡Ø§ Ø§Ù„Ø¢Ù†"ØŒ ÙˆØ§Ø³ØªÙ…Ø¹ Ù„Ù„Ù…Ø³Ø§Ø± Ø§Ù„ØµÙˆØªÙŠ Ø§Ù„Ø·Ø¨ÙŠØ¹ÙŠØŒ Ø«Ù… Ø´Ø§Ø±Ùƒ ØªØ³Ø¬ÙŠÙ„Ùƒ Ø¹Ù„Ù‰ ØµÙØ­Ø© Ø§Ù„Ù…Ø¬ØªÙ…Ø¹!</p>
                </div>
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-2xl font-bold text-gray-700 mb-3">ğŸ”œ Ù…Ø¹Ø§ÙŠÙ†Ø© Ø§Ù„Ø¯Ø±ÙˆØ³ Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©</h3>
                    <p class="text-lg text-gray-600"><strong>Ø§Ù„Ø¯Ø±Ø³ 2:</strong> Se prÃ©senter - ØªÙ‚Ø¯ÙŠÙ… Ø§Ù„Ù†ÙØ³.</p>
                    <p class="text-lg text-gray-600"><strong>Ø§Ù„Ø¯Ø±Ø³ 3:</strong> Salutations - Ø§Ù„ØªØ­ÙŠØ§Øª Ø§Ù„Ù‚ØµÙŠØ±Ø©.</p>
                </div>
            </footer>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const dialogueContainer = document.getElementById('dialogue-container');
            const toggleBtn = document.getElementById('toggle-translation-btn');
            
            // --- Speech Synthesis Setup ---
            let voices = [];
            const synth = window.speechSynthesis;
            function populateVoiceList() {
                voices = synth.getVoices().filter(voice => voice.lang.startsWith('fr'));
            }
            populateVoiceList();
            if (synth.onvoiceschanged !== undefined) {
                synth.onvoiceschanged = populateVoiceList;
            }

            function playSpeech(text, rate = 1.0) {
                // If speech is already in progress, cancel it to prevent errors from rapid clicks.
                if (synth.speaking) {
                    synth.cancel();
                }

                // Use a short timeout to give the synth time to cancel properly before speaking again.
                setTimeout(() => {
                    // Double-check if voices are loaded, as it can be asynchronous.
                    if (voices.length === 0) {
                        populateVoiceList();
                    }
                     if (voices.length === 0) {
                        console.error("Speech synthesis voices not available.");
                        return;
                    }

                    const utterance = new SpeechSynthesisUtterance(text);
                    utterance.onerror = (event) => {
                        console.error("SpeechSynthesisUtterance.onerror: An error occurred.", event);
                    };
                    
                    // Select a French voice
                    const frenchVoice = voices.find(voice => voice.lang === 'fr-FR');
                    if (frenchVoice) {
                        utterance.voice = frenchVoice;
                    } else {
                        console.warn("fr-FR voice not found, using browser default for the language.");
                    }
                    
                    utterance.lang = 'fr-FR';
                    utterance.pitch = 1;
                    utterance.rate = rate;
                    
                    synth.speak(utterance);
                }, 100);
            }

            const dialogueData = [
                { speaker: 'A', fr: "Bonjour, je voudrais un cafÃ©, sâ€™il vous plaÃ®t.", pron: "Ø¨ÙˆÙ†Ø¬ÙˆØ±ØŒ Ø¬Ù ÙˆÙØ¯ØºÙŠÙ‡ Ø£ÙÙ†Ù’ ÙƒØ§ÙÙŠÙ‡ØŒ Ø³ÙŠÙ„ ÙÙ Ø¨Ù„ÙŠÙ‡.", ar: "ØµØ¨Ø§Ø­ Ø§Ù„Ø®ÙŠØ±ØŒ Ø£ÙˆØ¯ Ù‚Ù‡ÙˆØ© Ù…Ù† ÙØ¶Ù„Ùƒ." },
                { speaker: 'B', fr: "Bien sÃ»r. Sucre ou sans sucre?", pron: "Ø¨Ù’ÙŠØ§Ù† Ø³ÙˆØ±. Ø³ÙˆÙƒØ± Ø£Ù Ø³ÙÙ†Ù’ Ø³ÙˆÙƒØ±ØŸ", ar: "Ø¨Ø§Ù„ØªØ£ÙƒÙŠØ¯. Ø¨Ø³ÙƒØ± Ø£Ù… Ø¨Ø¯ÙˆÙ† Ø³ÙƒØ±ØŸ" },
                { speaker: 'A', fr: "Sans sucre, merci.", pron: "Ø³ÙÙ†Ù’ Ø³ÙˆÙƒØ±ØŒ Ù…ÙŠØ±Ø³ÙŠ.", ar: "Ø¨Ø¯ÙˆÙ† Ø³ÙƒØ±ØŒ Ø´ÙƒØ±Ù‹Ø§." },
                { speaker: 'B', fr: "Taille? Petit ou grand?", pron: "ØªØ§ÙŠØŸ Ø¨ÙØªÙŠ Ø£Ù ØºØºØ§Ù†ØŸ", ar: "Ø§Ù„Ø­Ø¬Ù…ØŸ ØµØºÙŠØ± Ø£Ù… ÙƒØ¨ÙŠØ±ØŸ" },
                { speaker: 'A', fr: "Petit, sâ€™il vous plaÃ®t.", pron: "Ø¨ÙØªÙŠØŒ Ø³ÙŠÙ„ ÙÙ Ø¨Ù„ÙŠÙ‡.", ar: "ØµØºÙŠØ±ØŒ Ù…Ù† ÙØ¶Ù„Ùƒ." },
                { speaker: 'B', fr: "Ã€ emporter ou sur place?", pron: "Ø¢ Ø£ÙÙ…Ù’Ø¨ÙˆØ±ØªÙŠ Ø£Ù Ø³ÙØº Ø¨Ù„Ø§Ø³ØŸ", ar: "Ø³ÙØ±ÙŠ Ø£Ù… Ù‡Ù†Ø§ØŸ" },
                { speaker: 'A', fr: "Sur place.", pron: "Ø³ÙØº Ø¨Ù„Ø§Ø³.", ar: "Ù‡Ù†Ø§." },
                { speaker: 'B', fr: "Ã‡a fait 20 livres.", pron: "Ø³Ø§ ÙÙŠÙ‡ ÙØ§Ù† Ù„ÙÙØ±.", ar: "Ø§Ù„Ø³Ø¹Ø± 20 Ø¬Ù†ÙŠÙ‡Ù‹Ø§." },
            ];

            dialogueData.forEach((line, index) => {
                const lineElement = document.createElement('div');
                lineElement.className = 'dialogue-line border-b pb-4';
                lineElement.innerHTML = `
                    <div class="flex items-start">
                        <span class="bg-indigo-600 text-white rounded-full w-8 h-8 flex items-center justify-center text-lg font-bold ml-4">${line.speaker}</span>
                        <div class="flex-1">
                            <p class="text-xl font-semibold ltr-text">${line.fr}</p>
                            <p class="text-md text-gray-500 rtl-text">${line.pron}</p>
                            <p class="text-md text-blue-600 font-semibold rtl-text translation">${line.ar}</p>
                        </div>
                        <div class="flex flex-col space-y-2 mr-3">
                             <button data-text="${line.fr}" data-rate="0.7" class="play-slow-btn bg-gray-200 text-gray-700 w-10 h-10 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors" title="ØªØ´ØºÙŠÙ„ Ø¨Ø·ÙŠØ¡">ğŸ¢</button>
                             <button data-text="${line.fr}" data-rate="1.0" class="play-normal-btn bg-gray-200 text-gray-700 w-10 h-10 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors" title="ØªØ´ØºÙŠÙ„ Ø·Ø¨ÙŠØ¹ÙŠ">â–¶ï¸</button>
                        </div>
                    </div>
                `;
                dialogueContainer.appendChild(lineElement);
            });
            
            dialogueContainer.addEventListener('click', function(e) {
                if (e.target.closest('.play-slow-btn') || e.target.closest('.play-normal-btn')) {
                    const button = e.target.closest('button');
                    const text = button.dataset.text;
                    const rate = parseFloat(button.dataset.rate);
                    playSpeech(text, rate);
                }
            });

            // --- Toggle Translation Logic ---
            let translationsVisible = false;
            toggleBtn.addEventListener('click', () => {
                translationsVisible = !translationsVisible;
                const translations = document.querySelectorAll('.translation');
                translations.forEach(t => {
                    t.classList.toggle('visible', translationsVisible);
                });
                toggleBtn.textContent = translationsVisible ? 'Ø¥Ø®ÙØ§Ø¡ Ø§Ù„ØªØ±Ø¬Ù…Ø©' : 'Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ØªØ±Ø¬Ù…Ø©';
            });

            // --- Quiz Logic ---
            // MCQ
            const mcqOptions = document.getElementById('mcq-quiz');
            const mcqFeedback = document.getElementById('mcq-feedback');
            mcqOptions.addEventListener('change', function(e) {
                if (e.target.name === 'mcq') {
                    const isCorrect = e.target.value === 'b';
                    mcqFeedback.style.display = 'block';
                    mcqFeedback.textContent = isCorrect ? 'Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø©! Ø£Ø­Ø³Ù†Øª.' : 'Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰.';
                    mcqFeedback.className = `quiz-feedback ${isCorrect ? 'correct' : 'incorrect'}`;
                }
            });

            // Scramble
            const scrambleInput = document.getElementById('scramble-input');
            const scrambleCheckBtn = document.getElementById('scramble-check-btn');
            const scrambleFeedback = document.getElementById('scramble-feedback');
            const correctScramble = "je voudrais un cafÃ©, sâ€™il vous plaÃ®t.";
            
            scrambleCheckBtn.addEventListener('click', function() {
                const userAnswer = scrambleInput.value.trim().toLowerCase().replace(/[,.]/g, '');
                const correctAnswerCleaned = correctScramble.toLowerCase().replace(/[,.]/g, '');
                const isCorrect = userAnswer === correctAnswerCleaned;
                scrambleFeedback.style.display = 'block';
                scrambleFeedback.textContent = isCorrect ? 'Ø±Ø§Ø¦Ø¹! Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©.' : `Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù‡ÙŠ: ${correctScramble}`;
                scrambleFeedback.className = `quiz-feedback ${isCorrect ? 'correct' : 'incorrect'}`;
            });
        });
    </script>
</body>
</html>

