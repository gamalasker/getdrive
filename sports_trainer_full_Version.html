<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø¨Ø§Ù„ÙØ±Ù†Ø³ÙŠØ© - Ù…Ù†ØµØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ù…ØªÙƒØ§Ù…Ù„Ø©</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0">
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">

<style>
:root{
  --grad-main:linear-gradient(135deg,#667eea,#764ba2);
  --grad-accent:linear-gradient(45deg,#48bb78,#38a169);
  --grad-blue:linear-gradient(45deg,#4299e1,#3182ce);
  --grad-danger:linear-gradient(45deg,#e53e3e,#c53030);
  --radius-lg:20px;
  --radius-md:14px;
  --shadow-sm:0 2px 8px rgba(0,0,0,.08);
  --shadow-md:0 6px 16px rgba(0,0,0,.12);
  --shadow-lg:0 10px 28px rgba(0,0,0,.18);
  --bg-card:#ffffff;
  --bg-soft:#f7fafc;
  --tx-dark:#2d3748;
  --tx-mid:#4a5568;
  --tx-soft:#718096;
  --tx-light:#e2e8f0;
  --border:#e2e8f0;
  --focus:#667eea;
  --warn:#dd6b20;
  --success:#38a169;
  --danger:#e53e3e;
  --info:#4299e1;
  --transition:.35s cubic-bezier(.4,.0,.2,1);
}
*{box-sizing:border-box;margin:0;padding:0;}
body{
  font-family:'Cairo',sans-serif;
  background:var(--grad-main);
  min-height:100vh;
  color:var(--tx-dark);
  -webkit-font-smoothing:antialiased;
}
::-webkit-scrollbar{width:10px;height:10px}
::-webkit-scrollbar-track{background:#2d3658}
::-webkit-scrollbar-thumb{background:#6c7bd9;border-radius:20px}
::-webkit-scrollbar-thumb:hover{background:#8d98ea}
.container{max-width:1320px;margin:0 auto;padding:0 20px;}
header.header{
  background:rgba(255,255,255,.97);
  backdrop-filter:blur(14px);
  box-shadow:var(--shadow-lg);
  padding:2.2rem 0 1.7rem;
  position:sticky;top:0;z-index:50;
  border-bottom:4px solid #4f5bd9;
}
.header h1{
  font-size:2.55rem;
  background:linear-gradient(90deg,#4c51bf,#805ad5,#d53f8c);
  -webkit-background-clip:text;
  color:transparent;
  font-weight:700;
  letter-spacing:.5px;
  margin-bottom:.5rem;
}
.header p{color:var(--tx-soft);font-size:1.05rem;font-weight:500;}
.header .meta-line{
  margin-top:.9rem;
  display:flex;
  flex-wrap:wrap;
  gap:.8rem;
  justify-content:center;
  font-size:.75rem;
  color:var(--tx-mid);
}
.meta-pill{
  background:var(--bg-soft);
  padding:.4rem .9rem;
  border-radius:30px;
  border:1px solid var(--border);
  display:inline-flex;
  gap:.45rem;
  align-items:center;
  font-weight:600;
  transition:var(--transition);
}
.meta-pill i{color:#5a67d8}
.meta-pill:hover{box-shadow:0 4px 12px rgba(0,0,0,.12);transform:translateY(-3px)}
nav.navigation{
  background:rgba(255,255,255,.94);
  backdrop-filter:blur(8px);
  box-shadow:var(--shadow-md);
  margin-bottom:1.8rem;
  border-radius:0 0 var(--radius-lg) var(--radius-lg);
  border-top:1px solid #edf2f7;
}
.nav-inner{
  display:flex;
  flex-wrap:wrap;
  gap:.65rem;
  justify-content:center;
  padding:1rem 1rem 1.2rem;
}
.nav-btn{
  background:linear-gradient(45deg,#6b74e6,#8563dd);
  color:#fff;
  border:none;
  padding:.75rem 1.3rem;
  border-radius:30px;
  font-size:.80rem;
  font-weight:600;
  letter-spacing:.5px;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:.55rem;
  position:relative;
  overflow:hidden;
  transition:var(--transition);
  box-shadow:var(--shadow-sm);
  min-width:135px;
  justify-content:center;
}
.nav-btn:before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.15),transparent 70%);
  opacity:0;
  transition:var(--transition);
}
.nav-btn:hover:before{opacity:1}
.nav-btn:hover{transform:translateY(-4px) scale(1.02)}
.nav-btn.active{
  background:var(--grad-accent);
  box-shadow:0 6px 18px rgba(56,161,105,.45);
}
.global-progress{
  background:rgba(255,255,255,.9);
  box-shadow:var(--shadow-md);
  border-radius:var(--radius-lg);
  padding:1rem 1.4rem;
  display:flex;
  flex-direction:column;
  gap:.65rem;
  margin-bottom:1.7rem;
  position:relative;
  overflow:hidden;
}
.global-progress:after{
  content:"";
  position:absolute;
  width:220px;
  height:220px;
  background:radial-gradient(circle at 45% 45%,rgba(102,126,234,.25),transparent 70%);
  top:-90px;left:-80px;
  pointer-events:none;
}
.gp-top{
  display:flex;
  align-items:center;
  justify-content:space-between;
  flex-wrap:wrap;
  gap:1rem;
  z-index:2;
}
.gp-title{
  font-weight:700;
  font-size:.95rem;
  color:var(--tx-mid);
  display:flex;
  align-items:center;
  gap:.5rem;
}
.progress-bar-shell{
  height:14px;
  background:#e2e8f0;
  border-radius:60px;
  overflow:hidden;
  position:relative;
  box-shadow:inset 0 0 4px rgba(0,0,0,.15);
}
.progress-fill{
  height:100%;
  width:0%;
  background:linear-gradient(90deg,#48bb78,#38a169,#4299e1,#805ad5);
  background-size:250% 100%;
  animation:moveGradient 8s linear infinite;
  transition:width .7s cubic-bezier(.6,.04,.24,.95);
  position:relative;
}
@keyframes moveGradient{
  0%{background-position:0 50%}
  50%{background-position:100% 50%}
  100%{background-position:0 50%}
}
.progress-stats{
  display:flex;
  gap:1rem;
  flex-wrap:wrap;
  font-size:.7rem;
  color:var(--tx-mid);
  font-weight:600;
  align-items:center;
}
.stat-badge{
  background:var(--bg-soft);
  padding:.45rem .75rem;
  border-radius:10px;
  border:1px solid var(--border);
  display:inline-flex;
  gap:.4rem;
  align-items:center;
}
.stat-badge i{color:#5a67d8}
.btn-reset-progress{
  background:var(--grad-danger);
  color:#fff;
  border:none;
  padding:.55rem .9rem;
  border-radius:12px;
  font-size:.7rem;
  font-weight:700;
  cursor:pointer;
  box-shadow:var(--shadow-sm);
  transition:var(--transition);
  display:inline-flex;
  align-items:center;
  gap:.4rem;
}
.btn-reset-progress:hover{transform:translateY(-3px) scale(1.05)}
main.main{
  padding-bottom:4rem;
}
.section{
  display:none;
  background:rgba(255,255,255,.96);
  backdrop-filter:blur(6px);
  border:1px solid #e5e9f7;
  border-radius:var(--radius-lg);
  padding:2rem 1.7rem 2.3rem;
  margin-bottom:2rem;
  box-shadow:var(--shadow-lg);
  position:relative;
  overflow:hidden;
}
.section.active{display:block;}
.section:before{
  content:"";
  position:absolute;
  width:320px;
  height:320px;
  background:radial-gradient(circle at 65% 35%,rgba(118,75,162,.18),transparent 70%);
  top:-160px;
  right:-140px;
  pointer-events:none;
  opacity:.55;
}
.section h2{
  font-size:1.55rem;
  font-weight:800;
  background:linear-gradient(90deg,#4f46e5,#764ba2,#d53f8c);
  -webkit-background-clip:text;
  color:transparent;
  margin-bottom:1.4rem;
  letter-spacing:.5px;
  position:relative;
  display:flex;
  gap:.6rem;
  align-items:center;
}
.flex-grid{
  display:grid;
  gap:1.4rem;
}
@media (min-width:820px){
  .flex-grid.cols-2{grid-template-columns:repeat(2,1fr);}
  .flex-grid.cols-3{grid-template-columns:repeat(3,1fr);}
  .flex-grid.cols-4{grid-template-columns:repeat(4,1fr);}
}
.card{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:16px;
  padding:1.2rem 1.05rem 1.35rem;
  position:relative;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  gap:.7rem;
  box-shadow:var(--shadow-sm);
  transition:var(--transition);
}
.card:hover{transform:translateY(-6px);box-shadow:var(--shadow-md);}
.card h3{
  font-size:1.05rem;
  margin:0;
  font-weight:700;
  display:flex;
  align-items:center;
  gap:.55rem;
  color:var(--tx-mid);
}
.tag{
  background:#edf2f7;
  padding:.35rem .7rem;
  border-radius:12px;
  font-size:.6rem;
  font-weight:700;
  letter-spacing:.4px;
  color:#4a5568;
  display:inline-flex;
  align-items:center;
  gap:.3rem;
}
.tag i{color:#667eea}
.rule-examples{
  display:flex;
  flex-direction:column;
  gap:.6rem;
  margin-top:.4rem;
}
.example-block{
  background:var(--bg-soft);
  border:1px solid var(--border);
  border-radius:12px;
  padding:.7rem .75rem .8rem;
  font-size:.8rem;
  display:grid;
  gap:.35rem;
  position:relative;
  overflow:hidden;
}
.example-block:before{
  content:"";
  position:absolute;
  width:90px;height:90px;
  background:radial-gradient(circle at 70% 25%,rgba(102,126,234,.25),transparent 70%);
  top:-40px;right:-40px;
  opacity:.4;
}
.example-fr{font-family:'Roboto',monospace;font-weight:600;color:#2d3748;font-size:.85rem;}
.example-ar{font-size:.7rem;color:var(--tx-soft);}
.inline-audio-btn{
  background:var(--grad-blue);
  border:none;
  color:#fff;
  padding:.45rem .8rem;
  border-radius:40px;
  font-size:.65rem;
  font-weight:700;
  cursor:pointer;
  display:inline-flex;
  align-items:center;
  gap:.4rem;
  transition:var(--transition);
  box-shadow:var(--shadow-sm);
}
.inline-audio-btn:hover{transform:translateY(-3px);}
.inline-audio-btn.playing{animation:pulse 1.1s infinite;background:var(--grad-accent);}
.section-toolbar{
  display:flex;
  flex-wrap:wrap;
  gap:.65rem;
  margin-bottom:1.1rem;
}
.filter-btn{
  background:#edf2f7;
  border:none;
  border-radius:30px;
  padding:.55rem 1.05rem;
  font-size:.7rem;
  font-weight:700;
  letter-spacing:.5px;
  cursor:pointer;
  color:#4a5568;
  display:inline-flex;
  align-items:center;
  gap:.45rem;
  box-shadow:var(--shadow-sm);
  transition:var(--transition);
  position:relative;
  overflow:hidden;
}
.filter-btn:after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.2),transparent);
  opacity:0;
  transition:var(--transition);
}
.filter-btn:hover:after{opacity:1}
.filter-btn.active{
  background:var(--grad-blue);
  color:#fff;
  box-shadow:0 5px 16px rgba(66,153,225,.45);
}
.search-box{
  position:relative;
  width:100%;
  max-width:420px;
}
.search-box input{
  width:100%;
  padding:.85rem 1rem .85rem 2.7rem;
  background:#ffffff;
  border:2px solid var(--border);
  border-radius:14px;
  font-family:'Cairo',sans-serif;
  font-size:.75rem;
  font-weight:600;
  color:var(--tx-mid);
  letter-spacing:.4px;
  transition:var(--transition);
  box-shadow:0 2px 6px rgba(0,0,0,.05);
}
.search-box input:focus{
  outline:none;
  border-color:var(--focus);
  box-shadow:0 0 0 4px rgba(102,126,234,.25);
}
.search-box i{
  position:absolute;
  left:1rem;
  top:50%;
  transform:translateY(-50%);
  font-size:.9rem;
  color:#a0aec0;
}
.vocab-grid{
  display:grid;
  gap:1rem;
}
@media (min-width:680px){
  .vocab-grid{grid-template-columns:repeat(auto-fit,minmax(210px,1fr));}
}
.vocab-card{
  background:var(--bg-card);
  border:1px solid var(--border);
  border-radius:18px;
  padding:1rem .9rem 1.15rem;
  box-shadow:var(--shadow-sm);
  display:flex;
  flex-direction:column;
  gap:.55rem;
  position:relative;
  cursor:pointer;
  transition:var(--transition);
  overflow:hidden;
}
.vocab-card:hover{transform:translateY(-6px);box-shadow:var(--shadow-md);}
.vocab-card.flipped{
  background:linear-gradient(135deg,#667eea,#764ba2);
  color:#ffffff;
  border-color:#667eea;
}
.vocab-front,.vocab-back{transition:var(--transition);}
.vocab-card.flipped .vocab-front{opacity:0;transform:translateY(-10px) scale(.9);pointer-events:none;}
.vocab-card:not(.flipped) .vocab-back{opacity:0;transform:translateY(10px) scale(.9);pointer-events:none;}
.vocab-term{font-size:1.05rem;font-weight:700;font-family:'Roboto',sans-serif;}
.vocab-pron{font-size:.68rem;color:#718096;font-weight:600;letter-spacing:.6px;}
.vocab-card.flipped .vocab-pron{color:#e2e8f0;}
.vocab-ar{font-size:.85rem;font-weight:600;}
.vocab-context{
  font-size:.62rem;
  line-height:1.4;
  color:#4a5568;
  background:#edf2f7;
  padding:.45rem .55rem;
  border-radius:10px;
  font-weight:600;
}
.vocab-card.flipped .vocab-context{background:rgba(255,255,255,.25);color:#fff;border:1px solid rgba(255,255,255,.35);}
.card-actions{
  display:flex;
  gap:.45rem;
  flex-wrap:wrap;
  margin-top:.3rem;
}
.sm-btn{
  background:var(--grad-blue);
  border:none;
  color:#fff;
  padding:.45rem .8rem;
  border-radius:30px;
  font-size:.6rem;
  font-weight:700;
  cursor:pointer;
  letter-spacing:.5px;
  box-shadow:var(--shadow-sm);
  transition:var(--transition);
  display:inline-flex;
  align-items:center;
  gap:.35rem;
}
.sm-btn:hover{transform:translateY(-3px)}
.sm-btn.outline{
  background:#edf2f7;
  color:#4a5568;
  border:1px solid #d2d9e8;
}
.sm-btn.outline:hover{
  background:#fff;
  box-shadow:0 4px 12px rgba(0,0,0,.15);
}
.sm-btn.playing{animation:pulse 1.1s infinite;background:var(--grad-accent);}
.phrases-wrapper{
  display:grid;
  gap:1.1rem;
}
.phrase-item{
  background:var(--bg-soft);
  border:1px solid var(--border);
  border-radius:18px;
  padding:1rem .95rem 1.05rem;
  position:relative;
  overflow:hidden;
  display:flex;
  flex-direction:column;
  gap:.55rem;
  box-shadow:var(--shadow-sm);
  transition:var(--transition);
}
.phrase-item:before{
  content:"";
  position:absolute;
  width:160px;height:160px;
  background:radial-gradient(circle at 70% 20%,rgba(66,153,225,.3),transparent 70%);
  top:-90px;right:-60px;
  opacity:.4;
  pointer-events:none;
}
.phrase-item:hover{transform:translateY(-6px);box-shadow:var(--shadow-md);}
.phrase-fr{
  font-family:'Roboto',monospace;
  font-weight:700;
  font-size:.95rem;
  color:#27304b;
}
.phrase-ar{
  font-size:.75rem;
  font-weight:600;
  color:#4a5568;
}
.phrase-context{
  font-size:.6rem;
  font-weight:600;
  letter-spacing:.5px;
  color:#718096;
  background:#ffffff;
  padding:.35rem .6rem;
  border-radius:10px;
  align-self:flex-start;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
}
.inline-controls{
  display:flex;
  flex-wrap:wrap;
  gap:.45rem;
}
.exercise-box{
  background:var(--bg-soft);
  border:1px solid var(--border);
  border-radius:16px;
  padding:1.2rem 1rem 1.4rem;
  display:flex;
  flex-direction:column;
  gap:.8rem;
  box-shadow:var(--shadow-sm);
  position:relative;
  overflow:hidden;
}
.exercise-box:after{
  content:"";
  position:absolute;
  width:180px;height:180px;
  background:radial-gradient(circle at 75% 25%,rgba(72,187,120,.3),transparent 70%);
  top:-120px;right:-100px;
  opacity:.45;
  pointer-events:none;
}
.fill-sentence{
  font-family:'Roboto',monospace;
  font-size:1.05rem;
  font-weight:600;
  color:#2d3748;
  line-height:1.6;
}
.fill-sentence input{
  font-family:'Roboto',monospace;
  font-size:.95rem;
  min-width:110px;
  padding:.5rem .65rem;
  border:2px solid #d1d9e8;
  border-radius:10px;
  font-weight:600;
  text-align:center;
  letter-spacing:.7px;
  transition:var(--transition);
  background:#fff;
}
.fill-sentence input:focus{
  outline:none;
  border-color:var(--focus);
  box-shadow:0 0 0 4px rgba(102,126,234,.2);
}
.fill-sentence input.correct{
  background:#f0fff4;
  border-color:#38a169;
  color:#22543d;
}
.fill-sentence input.incorrect{
  background:#fff5f5;
  border-color:#e53e3e;
  color:#742a2a;
}
.translation-line{
  font-size:.75rem;
  font-weight:600;
  color:#4a5568;
  background:#ffffff;
  padding:.55rem .75rem;
  border-radius:10px;
  box-shadow:0 2px 6px rgba(0,0,0,.08);
  display:flex;
  align-items:center;
  gap:.55rem;
}
.hint-box{
  background:#e6fffa;
  border:1px solid #b2f5ea;
  border-left:5px solid #38b2ac;
  padding:.65rem .8rem .7rem;
  border-radius:12px;
  font-size:.65rem;
  font-weight:700;
  letter-spacing:.5px;
  color:#234e52;
  display:none;
  line-height:1.5;
}
.options-line{
  font-size:.65rem;
  font-weight:700;
  letter-spacing:1px;
  color:#718096;
  background:#fff;
  padding:.45rem .7rem;
  border-radius:10px;
  box-shadow:0 2px 5px rgba(0,0,0,.05);
  display:inline-flex;
  gap:.4rem;
  flex-wrap:wrap;
}
.inline-audio-group{
  display:flex;
  gap:.5rem;
  align-items:center;
  flex-wrap:wrap;
  margin-top:.4rem;
}
.score-chip{
  display:inline-flex;
  align-items:center;
  gap:.45rem;
  background:#fff;
  padding:.55rem .85rem;
  border-radius:50px;
  font-size:.65rem;
  font-weight:700;
  letter-spacing:.5px;
  box-shadow:0 3px 10px rgba(0,0,0,.12);
  border:1px solid #e2e8f0;
  color:#2d3748;
}
.big-btn{
  background:var(--grad-accent);
  border:none;
  color:#fff;
  padding:.75rem 1.25rem;
  font-size:.75rem;
  font-weight:700;
  letter-spacing:.7px;
  border-radius:14px;
  cursor:pointer;
  box-shadow:0 4px 12px rgba(72,187,120,.45);
  display:inline-flex;
  align-items:center;
  gap:.6rem;
  position:relative;
  overflow:hidden;
  transition:var(--transition);
}
.big-btn.blue{
  background:var(--grad-blue);
  box-shadow:0 4px 12px rgba(66,153,225,.45);
}
.big-btn.gray{
  background:#e2e8f0;
  color:#2d3748;
  box-shadow:0 4px 10px rgba(0,0,0,.08);
}
.big-btn.danger{
  background:var(--grad-danger);
  box-shadow:0 4px 12px rgba(229,62,62,.45);
}
.big-btn:hover{transform:translateY(-4px) scale(1.02);}
.big-btn:after{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(135deg,rgba(255,255,255,.25),transparent);
  opacity:0;
  transition:var(--transition);
}
.big-btn:hover:after{opacity:1}
.btn-row{
  display:flex;
  gap:.75rem;
  flex-wrap:wrap;
  margin-top:.9rem;
}
.dragdrop-shell{
  background:var(--bg-soft);
  border:1px solid var(--border);
  border-radius:20px;
  padding:1rem .95rem 1.3rem;
  box-shadow:var(--shadow-sm);
  display:flex;
  flex-direction:column;
  gap:1rem;
}
.dd-flex{
  display:grid;
  gap:1.1rem;
}
@media (min-width:820px){
  .dd-flex{grid-template-columns:320px 1fr;}
}
.word-pool{
  background:#ffffff;
  border:2px dashed #c3cee0;
  min-height:170px;
  border-radius:18px;
  padding:.7rem .7rem .6rem;
  display:flex;
  flex-wrap:wrap;
  gap:.55rem;
  align-content:flex-start;
  position:relative;
}
.draggable-word{
  background:linear-gradient(45deg,#667eea,#764ba2);
  color:#fff;
  border:none;
  border-radius:50px;
  padding:.55rem 1.05rem;
  font-size:.68rem;
  font-weight:700;
  letter-spacing:.5px;
  cursor:grab;
  display:inline-flex;
  gap:.5rem;
  align-items:center;
  position:relative;
  box-shadow:0 4px 10px rgba(102,126,234,.45);
  transition:var(--transition);
}
.draggable-word:hover{transform:translateY(-4px) scale(1.06)}
.draggable-word:active{cursor:grabbing}
.sentences-zone{
  display:flex;
  flex-direction:column;
  gap:.85rem;
}
.dd-sentence{
  background:#ffffff;
  border:2px dashed #cbd5e0;
  border-radius:18px;
  padding:.75rem .85rem;
  min-height:78px;
  font-size:.85rem;
  font-weight:600;
  display:flex;
  align-items:center;
  gap:.55rem;
  flex-wrap:wrap;
  line-height:1.5;
  position:relative;
  transition:var(--transition);
}
.dd-sentence.drag-over{background:#edf2f7;border-color:#667eea;}
.drop-slot{
  background:#e6ebf5;
  border:2px dashed #a0aec0;
  border-radius:12px;
  padding:.45rem .9rem;
  min-width:95px;
  text-align:center;
  font-size:.7rem;
  font-weight:700;
  color:#4a5568;
  letter-spacing:.5px;
  cursor:pointer;
  transition:var(--transition);
  position:relative;
}
.drop-slot.filled{
  background:#c6f6d5;
  border-color:#48bb78;
  color:#22543d;
  box-shadow:0 0 0 1px #48bb78;
}
.sentence-audio{
  position:absolute;
  top:6px;
  left:6px;
  background:var(--grad-blue);
  color:#fff;
  border:none;
  width:34px;
  height:34px;
  border-radius:50%;
  font-size:.65rem;
  font-weight:700;
  cursor:pointer;
  box-shadow:0 4px 12px rgba(66,153,225,.45);
  display:flex;
  align-items:center;
  justify-content:center;
  transition:var(--transition);
}
.sentence-audio:hover{transform:translateY(-3px)}
.dd-translation{
  font-size:.55rem;
  font-weight:700;
  color:#718096;
  width:100%;
}
.pronunciation-trainer{
  background:var(--bg-soft);
  border:1px solid var(--border);
  border-radius:20px;
  padding:1.2rem 1rem 1.5rem;
  display:flex;
  flex-direction:column;
  gap:1rem;
  box-shadow:var(--shadow-sm);
  position:relative;
  overflow:hidden;
}
.pronunciation-trainer:before{
  content:"";
  position:absolute;
  width:260px;height:260px;
  top:-140px;left:-140px;
  background:radial-gradient(circle at 60% 40%,rgba(66,153,225,.25),transparent 70%);
  opacity:.5;
  pointer-events:none;
}
.mode-tabs{
  display:flex;
  flex-wrap:wrap;
  gap:.6rem;
}
.mode-btn{
  background:#edf2f7;
  border:1px solid #d2d9e8;
  border-radius:30px;
  padding:.6rem 1.1rem;
  font-size:.65rem;
  font-weight:700;
  letter-spacing:.5px;
  color:#4a5568;
  cursor:pointer;
  transition:var(--transition);
  box-shadow:var(--shadow-sm);
}
.mode-btn.active{
  background:var(--grad-blue);
  color:#ffffff;
  border-color:#4299e1;
  box-shadow:0 4px 14px rgba(66,153,225,.45);
}
.pron-content{
  background:#ffffff;
  border:1px solid var(--border);
  border-radius:16px;
  padding:1.2rem .95rem 1.3rem;
  display:flex;
  flex-direction:column;
  gap:.7rem;
  position:relative;
  overflow:hidden;
  box-shadow:var(--shadow-sm);
  min-height:125px;
}
.pron-content:after{
  content:"";
  position:absolute;
  width:170px;height:170px;
  background:radial-gradient(circle at 70% 25%,rgba(118,75,162,.25),transparent 70%);
  top:-100px;right:-80px;
  opacity:.4;
  pointer-events:none;
}
.pron-fr{
  font-family:'Roboto',monospace;
  font-size:1.3rem;
  font-weight:700;
  color:#2d3748;
  letter-spacing:.5px;
}
.pron-ar{
  font-size:.8rem;
  font-weight:600;
  color:#4a5568;
}
.pron-phon{
  font-size:.7rem;
  font-weight:700;
  letter-spacing:.6px;
  color:#4299e1;
}
.pron-tip{
  background:#e6fffa;
  border:1px solid #b2f5ea;
  padding:.55rem .7rem;
  border-radius:12px;
  font-size:.6rem;
  font-weight:700;
  letter-spacing:.5px;
  color:#285e61;
  line-height:1.5;
}
.pron-buttons{
  display:flex;
  flex-wrap:wrap;
  gap:.6rem;
  margin-top:.5rem;
}
.quiz-box{
  background:var(--bg-soft);
  border:1px solid var(--border);
  border-radius:20px;
  padding:1.3rem 1rem 1.6rem;
  display:flex;
  flex-direction:column;
  gap:1rem;
  position:relative;
  overflow:hidden;
  box-shadow:var(--shadow-sm);
}
.quiz-box:before{
  content:"";
  position:absolute;
  width:250px;height:250px;
  top:-150px;right:-150px;
  background:radial-gradient(circle at 65% 30%,rgba(229,62,62,.3),transparent 70%);
  pointer-events:none;
  opacity:.35;
}
.quiz-header{
  display:flex;
  flex-wrap:wrap;
  gap:.75rem;
  align-items:center;
  justify-content:space-between;
  font-size:.7rem;
  font-weight:700;
  letter-spacing:.6px;
  color:#4a5568;
}
.timer-badge{
  background:#fff5f5;
  color:#c53030;
  padding:.5rem .8rem;
  border-radius:12px;
  border:1px solid #fed7d7;
  display:inline-flex;
  gap:.45rem;
  align-items:center;
  box-shadow:0 2px 6px rgba(229,62,62,.3);
  font-size:.65rem;
}
.q-progress{
  background:#ffffff;
  padding:.55rem .9rem;
  border-radius:12px;
  border:1px solid var(--border);
  display:inline-flex;
  gap:.4rem;
  align-items:center;
  font-size:.65rem;
  font-weight:700;
  letter-spacing:.5px;
  color:#2d3748;
}
.quiz-question{
  background:#ffffff;
  border:1px solid var(--border);
  border-radius:16px;
  padding:1rem .9rem 1.15rem;
  font-size:.9rem;
  font-weight:700;
  line-height:1.6;
  letter-spacing:.4px;
  position:relative;
  box-shadow:var(--shadow-sm);
}
.quiz-options{
  display:grid;
  gap:.75rem;
}
@media (min-width:640px){
  .quiz-options{grid-template-columns:repeat(auto-fit,minmax(200px,1fr));}
}
.quiz-option{
  background:#ffffff;
  border:2px solid #cbd5e0;
  padding:.85rem .9rem;
  border-radius:16px;
  font-size:.7rem;
  font-weight:800;
  letter-spacing:.7px;
  cursor:pointer;
  display:flex;
  align-items:center;
  justify-content:center;
  text-align:center;
  box-shadow:0 3px 10px rgba(0,0,0,.06);
  position:relative;
  overflow:hidden;
  transition:var(--transition);
}
.quiz-option:before{
  content:"";
  position:absolute;
  inset:0;
  background:linear-gradient(120deg,rgba(255,255,255,.28),transparent 60%);
  opacity:0;
  transition:var(--transition);
}
.quiz-option:hover:before{opacity:1}
.quiz-option:hover{transform:translateY(-4px)}
.quiz-option.selected{
  background:var(--grad-blue);
  color:#ffffff;
  border-color:#4299e1;
  box-shadow:0 5px 14px rgba(66,153,225,.45);
}
.quiz-option.correct{
  background:#f0fff4;
  color:#22543d;
  border-color:#48bb78;
  box-shadow:0 4px 12px rgba(72,187,120,.45);
}
.quiz-option.incorrect{
  background:#fff5f5;
  color:#742a2a;
  border-color:#e53e3e;
  box-shadow:0 4px 12px rgba(229,62,62,.35);
}
.quiz-actions{
  display:flex;
  flex-wrap:wrap;
  gap:.7rem;
}
.quiz-results{
  background:#ffffff;
  border:1px solid var(--border);
  border-radius:20px;
  padding:1.4rem 1rem 1.6rem;
  margin-top:.9rem;
  display:none;
  flex-direction:column;
  gap:1rem;
  position:relative;
  overflow:hidden;
  box-shadow:var(--shadow-md);
}
.quiz-results:after{
  content:"";
  position:absolute;
  width:300px;height:300px;
  background:radial-gradient(circle at 65% 25%,rgba(72,187,120,.35),transparent 70%);
  top:-170px;left:-150px;
  opacity:.45;
  pointer-events:none;
}
.final-score{
  font-size:2rem;
  font-weight:800;
  letter-spacing:1px;
  background:linear-gradient(90deg,#48bb78,#38a169,#4299e1,#764ba2);
  -webkit-background-clip:text;
  color:transparent;
}
.medal-badge{
  font-size:3.2rem;
  line-height:1;
  filter:drop-shadow(0 4px 10px rgba(0,0,0,.25));
  animation:popMedal .9s ease;
}
@keyframes popMedal{
  0%{transform:scale(0) rotate(-180deg);opacity:0}
  60%{transform:scale(1.15) rotate(20deg);opacity:1}
  100%{transform:scale(1) rotate(0deg);}
}
.score-breakdown{
  display:grid;
  gap:.9rem;
  margin-top:.6rem;
}
@media (min-width:640px){
  .score-breakdown{grid-template-columns:repeat(auto-fit,minmax(170px,1fr));}
}
.break-card{
  background:var(--bg-soft);
  border:1px solid var(--border);
  border-radius:14px;
  padding:.8rem .75rem .9rem;
  font-size:.65rem;
  font-weight:700;
  color:#4a5568;
  display:flex;
  flex-direction:column;
  gap:.35rem;
  position:relative;
  overflow:hidden;
}
.break-card:before{
  content:"";
  position:absolute;
  width:130px;height:130px;
  background:radial-gradient(circle at 70% 25%,rgba(102,126,234,.24),transparent 70%);
  top:-70px;right:-60px;
  opacity:.35;
  pointer-events:none;
}
.footer{
  background:rgba(255,255,255,.92);
  backdrop-filter:blur(8px);
  padding:2rem 0 2.4rem;
  margin-top:3rem;
  text-align:center;
  font-size:.7rem;
  font-weight:600;
  color:#4a5568;
  box-shadow:0 -2px 14px rgba(0,0,0,.12);
  border-top:3px solid #5d68e0;
  position:relative;
  overflow:hidden;
}
.footer:before{
  content:"";
  position:absolute;
  width:400px;height:400px;
  background:radial-gradient(circle at 50% 50%,rgba(102,126,234,.22),transparent 70%);
  top:-200px;left:-180px;
}
.footer:after{
  content:"";
  position:absolute;
  width:300px;height:300px;
  background:radial-gradient(circle at 60% 35%,rgba(118,75,162,.25),transparent 70%);
  right:-160px;top:-160px;
}
.feedback{
  position:fixed;
  top:18px;
  right:18px;
  display:flex;
  align-items:center;
  gap:.65rem;
  background:#4299e1;
  color:#fff;
  padding:.85rem 1.1rem .9rem;
  border-radius:16px;
  font-size:.7rem;
  font-weight:800;
  letter-spacing:.6px;
  box-shadow:0 6px 22px rgba(0,0,0,.3);
  z-index:9999;
  animation:slideIn .5s;
  max-width:320px;
  line-height:1.5;
}
.feedback.success{background:#38a169}
.feedback.error{background:#e53e3e}
.feedback.warning{background:#dd6b20}
.feedback.info{background:#4299e1}
@keyframes slideIn{
  0%{opacity:0;transform:translateX(40px) scale(.95)}
  100%{opacity:1;transform:translateX(0) scale(1)}
}
@keyframes slideOut{
  0%{opacity:1;transform:translateX(0) scale(1)}
  100%{opacity:0;transform:translateX(30px) scale(.9)}
}
.audio-loading{
  position:fixed;
  top:50%;left:50%;
  transform:translate(-50%,-50%);
  background:rgba(15,23,42,.9);
  color:#fff;
  padding:1.2rem 1.6rem;
  border-radius:20px;
  font-size:.8rem;
  font-weight:700;
  display:none;
  flex-direction:column;
  gap:.55rem;
  align-items:center;
  box-shadow:0 10px 30px rgba(0,0,0,.4);
  z-index:9998;
  letter-spacing:.8px;
  min-width:240px;
}
.audio-loading .spinner{
  width:40px;height:40px;
  border:5px solid rgba(255,255,255,.2);
  border-top:5px solid #48bb78;
  border-radius:50%;
  animation:spin 1s linear infinite;
}
@keyframes spin{
  to{transform:rotate(360deg);}
}
.playing{animation:pulse 1.1s infinite}
@keyframes pulse{
  0%{transform:scale(1)}
  50%{transform:scale(1.08)}
  100%{transform:scale(1)}
}
/* Responsive tweaks */
@media (max-width:640px){
  .header h1{font-size:2.05rem}
  .nav-btn{flex:1 1 calc(50% - .8rem);min-width:120px}
  .section{padding:1.6rem 1rem 1.9rem}
  .big-btn{flex:1 1 140px;justify-content:center}
  .quiz-question{font-size:.85rem}
  .fill-sentence{font-size:.95rem}
  .pron-fr{font-size:1.1rem}
}
@media (prefers-reduced-motion:reduce){
  *{animation:none!important;transition:none!important}
}
.sr-only{
  position:absolute;
  width:1px;
  height:1px;
  padding:0;
  margin:-1px;
  overflow:hidden;
  clip:rect(0 0 0 0);
  border:0;
}
</style>
</head>
<body>

<header class="header">
  <div class="container">
    <h1><i class="fas fa-dumbbell"></i> Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø¨Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©</h1>
    <p>Ù…Ù†ØµØ© ØªÙØ§Ø¹Ù„ÙŠØ© Ø´Ø§Ù…Ù„Ø©: Ù…ÙØ±Ø¯Ø§Øª â€“ ØªÙ…Ø§Ø±ÙŠÙ† â€“ Ù†Ø·Ù‚ â€“ ØªÙ‚ÙŠÙŠÙ… â€“ Ø­ÙØ¸ ØªÙ‚Ø¯Ù…Ùƒ</p>
    <div class="meta-line">
      <span class="meta-pill"><i class="fas fa-user"></i> Ø§Ù„Ø·Ø§Ù„Ø¨: <strong id="userName">Ø·Ø§Ù„Ø¨</strong></span>
      <span class="meta-pill"><i class="fas fa-calendar"></i> <span id="todayDate"></span></span>
      <span class="meta-pill"><i class="fas fa-hourglass-half"></i> Ù…Ø¯Ø© Ø§Ù„Ø¬Ù„Ø³Ø©: <span id="sessionTimer">00:00</span></span>
      <span class="meta-pill"><i class="fas fa-medal"></i> Ø¥Ù†Ø¬Ø§Ø²: <span id="engagementLevel">0%</span></span>
    </div>
  </div>
</header>

<nav class="navigation" aria-label="Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠ">
  <div class="nav-inner container" id="navBar">
    <button class="nav-btn active" data-section="grammar"><i class="fas fa-book"></i> Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯</button>
    <button class="nav-btn" data-section="vocabulary"><i class="fas fa-list-ul"></i> Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª</button>
    <button class="nav-btn" data-section="phrases"><i class="fas fa-comments"></i> Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª</button>
    <button class="nav-btn" data-section="pronunciation"><i class="fas fa-volume-up"></i> ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ø·Ù‚</button>
    <button class="nav-btn" data-section="exercise1"><i class="fas fa-pencil-alt"></i> ØªÙ…Ø±ÙŠÙ† 1</button>
    <button class="nav-btn" data-section="exercise2"><i class="fas fa-puzzle-piece"></i> ØªÙ…Ø±ÙŠÙ† 2</button>
    <button class="nav-btn" data-section="quiz"><i class="fas fa-trophy"></i> Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
  </div>
</nav>

<section class="global-progress container" aria-label="Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ø§Ù…">
  <div class="gp-top">
    <div class="gp-title"><i class="fas fa-chart-line"></i> Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„ÙƒÙ„ÙŠ</div>
    <div class="progress-stats" id="progressStats">
      <span class="stat-badge" title="ØªÙ…Ø§Ø±ÙŠÙ† Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§Øº">
        <i class="fas fa-edit"></i> <span id="statFill">0/0</span>
      </span>
      <span class="stat-badge" title="Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª">
        <i class="fas fa-object-group"></i> <span id="statDrag">0/0</span>
      </span>
      <span class="stat-badge" title="Ø£Ø³Ø¦Ù„Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±">
        <i class="fas fa-question-circle"></i> <span id="statQuiz">0/0</span>
      </span>
      <span class="stat-badge" title="Ø§Ù„Ù†Ø·Ù‚ (Ø¹Ù†Ø§ØµØ±)">
        <i class="fas fa-headphones"></i> <span id="statPron">0/0</span>
      </span>
    </div>
    <button class="btn-reset-progress" id="btnResetAll" aria-label="Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ØªÙ‚Ø¯Ù…"><i class="fas fa-rotate"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø·</button>
  </div>
  <div class="progress-bar-shell" aria-hidden="true">
    <div class="progress-fill" id="globalProgressFill"></div>
  </div>
</section>

<main class="main container" id="mainContent">

  <!-- Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ -->
  <section class="section active" id="grammar" tabindex="0">
    <h2><i class="fas fa-book-open"></i> Ø§Ù„Ù‚ÙˆØ§Ø¹Ø¯ Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© (FAIRE / JOUER)</h2>
    <div class="flex-grid cols-2">
      <div class="card">
        <h3><i class="fas fa-fire-alt"></i> ÙØ¹Ù„ FAIRE</h3>
        <div class="tag"><i class="fas fa-info-circle"></i> ÙŠØ³ØªØ®Ø¯Ù… Ù…Ø¹ Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ© Ø£Ùˆ Ø§Ù„Ø£Ù†Ø´Ø·Ø© Ø¨Ù„Ø§ ÙƒØ±Ø©</div>
        <p style="font-size:.8rem;line-height:1.6;font-weight:600;color:#4a5568">
          Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: <strong>FAIRE + (du / de la / de lâ€™ + Ø±ÙŠØ§Ø¶Ø© ÙØ±Ø¯ÙŠØ©)</strong><br>
          Ù†Ø®ØªØ§Ø± Ø§Ù„Ø£Ø¯Ø§Ø© Ø­Ø³Ø¨ Ø¬Ù†Ø³ Ø§Ù„ÙƒÙ„Ù…Ø© ÙˆØ¨Ø¯Ø§ÙŠØªÙ‡Ø§.
        </p>
        <div class="rule-examples">
          <div class="example-block">
            <div class="example-fr">Je fais du judo</div>
            <div class="example-ar">Ø£Ù†Ø§ Ø£Ù…Ø§Ø±Ø³ Ø§Ù„Ø¬ÙˆØ¯Ùˆ</div>
            <button class="inline-audio-btn" data-say="Je fais du judo">ğŸ”Š Ù†Ø·Ù‚</button>
          </div>
          <div class="example-block">
            <div class="example-fr">Elle fait de la natation</div>
            <div class="example-ar">Ù‡ÙŠ ØªÙ…Ø§Ø±Ø³ Ø§Ù„Ø³Ø¨Ø§Ø­Ø©</div>
            <button class="inline-audio-btn" data-say="Elle fait de la natation">ğŸ”Š Ù†Ø·Ù‚</button>
          </div>
          <div class="example-block">
            <div class="example-fr">Tu fais de l'Ã©quitation</div>
            <div class="example-ar">Ø£Ù†Øª ØªÙ…Ø§Ø±Ø³ Ø§Ù„ÙØ±ÙˆØ³ÙŠØ©</div>
            <button class="inline-audio-btn" data-say="Tu fais de l Ã©quitation">ğŸ”Š Ù†Ø·Ù‚</button>
          </div>
        </div>
      </div>
      <div class="card">
        <h3><i class="fas fa-futbol"></i> ÙØ¹Ù„ JOUER</h3>
        <div class="tag"><i class="fas fa-info-circle"></i> ÙŠØ³ØªØ®Ø¯Ù… Ù…Ø¹ Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª Ø¨Ø§Ù„ÙƒØ±Ø© / Ø£Ù„Ø¹Ø§Ø¨ Ø¬Ù…Ø§Ø¹ÙŠØ©</div>
        <p style="font-size:.8rem;line-height:1.6;font-weight:600;color:#4a5568">
          Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø©: <strong>JOUER + (au / Ã  la / aux + Ù„Ø¹Ø¨Ø©)</strong><br>
          Ù†Ø³ØªØ®Ø¯Ù… (au) Ù„Ù„Ù…ÙØ±Ø¯ Ø§Ù„Ù…Ø°ÙƒØ±ØŒ (Ã  la) Ù„Ù„Ù…ÙØ±Ø¯ Ø§Ù„Ù…Ø¤Ù†Ø«ØŒ (aux) Ù„Ù„Ø¬Ù…Ø¹.
        </p>
        <div class="rule-examples">
          <div class="example-block">
            <div class="example-fr">Nous jouons au football</div>
            <div class="example-ar">Ù†Ø­Ù† Ù†Ù„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…</div>
            <button class="inline-audio-btn" data-say="Nous jouons au football">ğŸ”Š Ù†Ø·Ù‚</button>
          </div>
            <div class="example-block">
              <div class="example-fr">Ils jouent au tennis</div>
              <div class="example-ar">Ù‡Ù… ÙŠÙ„Ø¹Ø¨ÙˆÙ† Ø§Ù„ØªÙ†Ø³</div>
              <button class="inline-audio-btn" data-say="Ils jouent au tennis">ğŸ”Š Ù†Ø·Ù‚</button>
            </div>
            <div class="example-block">
              <div class="example-fr">Vous jouez Ã  la pÃ©tanque</div>
              <div class="example-ar">Ø£Ù†ØªÙ… ØªÙ„Ø¹Ø¨ÙˆÙ† Ø§Ù„Ø¨ÙŠØªØ§Ù†Ùƒ</div>
              <button class="inline-audio-btn" data-say="Vous jouez Ã  la pÃ©tanque">ğŸ”Š Ù†Ø·Ù‚</button>
            </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª -->
  <section class="section" id="vocabulary">
    <h2><i class="fas fa-list-ul"></i> Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ©</h2>
    <div class="section-toolbar">
      <button class="filter-btn active" data-vcat="places"><i class="fas fa-map-marked-alt"></i> Ø§Ù„Ø£Ù…Ø§ÙƒÙ†</button>
      <button class="filter-btn" data-vcat="people"><i class="fas fa-users"></i> Ø§Ù„Ø£Ø´Ø®Ø§Øµ</button>
      <button class="filter-btn" data-vcat="equipment"><i class="fas fa-toolbox"></i> Ø§Ù„Ø£Ø¯ÙˆØ§Øª</button>
      <button class="filter-btn" data-vcat="sports"><i class="fas fa-basketball-ball"></i> Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª</button>
      <button class="filter-btn" data-vcat="actions"><i class="fas fa-running"></i> Ø§Ù„Ø£ÙØ¹Ø§Ù„</button>
      <div class="search-box">
        <input type="text" id="vocabSearch" placeholder="ğŸ” Ø§Ø¨Ø­Ø« ÙØ±Ù†Ø³ÙŠ / Ø¹Ø±Ø¨ÙŠ...">
        <i class="fas fa-search"></i>
      </div>
    </div>
    <div class="vocab-grid" id="vocabGrid" aria-live="polite"></div>
  </section>

  <!-- Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª -->
  <section class="section" id="phrases">
    <h2><i class="fas fa-comments"></i> Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª ÙˆØ§Ù„Ø¬Ù…Ù„ Ø§Ù„Ø´Ø§Ø¦Ø¹Ø©</h2>
    <div class="section-toolbar">
      <button class="filter-btn active" data-pcat="asking"><i class="fas fa-question"></i> Ø§Ù„Ø³Ø¤Ø§Ù„</button>
      <button class="filter-btn" data-pcat="describing"><i class="fas fa-align-left"></i> Ø§Ù„ÙˆØµÙ</button>
      <button class="filter-btn" data-pcat="expressing"><i class="fas fa-heart"></i> Ø§Ù„Ø¥Ø¹Ø¬Ø§Ø¨</button>
      <button class="filter-btn" data-pcat="conversation"><i class="fas fa-handshake"></i> Ù…Ø­Ø§Ø¯Ø«Ø©</button>
    </div>
    <div class="phrases-wrapper" id="phrasesWrapper" aria-live="polite"></div>
  </section>

  <!-- ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ø·Ù‚ -->
  <section class="section" id="pronunciation">
    <h2><i class="fas fa-volume-up"></i> ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ø·Ù‚</h2>
    <div class="pronunciation-trainer">
      <div class="mode-tabs">
        <button class="mode-btn active" data-pmode="word">ÙƒÙ„Ù…Ø§Øª</button>
        <button class="mode-btn" data-pmode="sentence">Ø¬Ù…Ù„</button>
        <button class="mode-btn" data-pmode="dialogue">Ø­ÙˆØ§Ø±</button>
      </div>
      <div class="pron-content" id="pronContent" aria-live="polite"></div>
      <div class="pron-buttons">
        <button class="big-btn blue" id="btnPronPlay"><i class="fas fa-play"></i> ØªØ´ØºÙŠÙ„</button>
        <button class="big-btn gray" id="btnPronSlow"><i class="fas fa-turtle"></i> Ø¨Ø·ÙŠØ¡</button>
        <button class="big-btn" id="btnPronNext"><i class="fas fa-forward"></i> Ø§Ù„ØªØ§Ù„ÙŠ</button>
        <button class="big-btn danger" id="btnPronRestart"><i class="fas fa-rotate-left"></i> Ø¥Ø¹Ø§Ø¯Ø©</button>
      </div>
      <div class="score-chip"><i class="fas fa-check-circle"></i> ØªÙ… / Ø§Ù„ÙƒÙ„: <span id="pronCounter">0/0</span></div>
    </div>
  </section>

  <!-- ØªÙ…Ø±ÙŠÙ† 1 -->
  <section class="section" id="exercise1">
    <h2><i class="fas fa-pencil-alt"></i> ØªÙ…Ø±ÙŠÙ† Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§Øº</h2>
    <div class="exercise-box" id="fillExerciseBox" aria-live="polite"></div>
    <div class="btn-row">
      <button class="big-btn" id="btnFillCheck"><i class="fas fa-check"></i> ØªØ­Ù‚Ù‚</button>
      <button class="big-btn blue" id="btnFillNext"><i class="fas fa-arrow-right"></i> Ø§Ù„ØªØ§Ù„ÙŠ</button>
      <button class="big-btn gray" id="btnFillHint"><i class="fas fa-lightbulb"></i> ØªÙ„Ù…ÙŠØ­</button>
      <button class="big-btn danger" id="btnFillRestart"><i class="fas fa-rotate-left"></i> Ø¥Ø¹Ø§Ø¯Ø©</button>
    </div>
    <div class="score-chip"><i class="fas fa-star"></i> Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="fillScoreDisplay">0</span></div>
  </section>

  <!-- ØªÙ…Ø±ÙŠÙ† 2 -->
  <section class="section" id="exercise2">
    <h2><i class="fas fa-puzzle-piece"></i> ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª</h2>
    <div class="dragdrop-shell">
      <p style="font-size:.75rem;font-weight:600;color:#4a5568">Ø§Ø³Ø­Ø¨ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØµØ­ÙŠØ­Ø© Ù„ØªÙƒÙ…ÙŠÙ„ Ø§Ù„Ø¬Ù…Ù„ØŒ Ø«Ù… ØªØ­Ù‚Ù‘Ù‚.</p>
      <div class="dd-flex">
        <div class="word-pool" id="ddWordPool" aria-label="Ù…Ø¬Ù…ÙˆØ¹Ø© Ø§Ù„ÙƒÙ„Ù…Ø§Øª"></div>
        <div class="sentences-zone" id="ddSentencesZone" aria-live="polite"></div>
      </div>
      <div class="btn-row">
        <button class="big-btn" id="btnDDCheck"><i class="fas fa-check-double"></i> ØªØ­Ù‚Ù‚</button>
        <button class="big-btn blue" id="btnDDReset"><i class="fas fa-rotate"></i> Ø¥Ø¹Ø§Ø¯Ø©</button>
        <button class="big-btn gray" id="btnDDSpeak"><i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø§Ù„ÙƒÙ„</button>
      </div>
      <div class="score-chip"><i class="fas fa-clipboard-check"></i> Ø§Ù„Ù†ØªÙŠØ¬Ø©: <span id="dragScoreDisplay">0</span></div>
    </div>
  </section>

  <!-- Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± -->
  <section class="section" id="quiz">
    <h2><i class="fas fa-trophy"></i> Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ</h2>
    <div class="quiz-box">
      <div class="quiz-header">
        <div class="q-progress"><i class="fas fa-list-ol"></i> Ø³Ø¤Ø§Ù„ <span id="quizProgressNum">1</span> / <span id="quizTotal">0</span></div>
        <div class="timer-badge"><i class="fas fa-clock"></i> Ø§Ù„ÙˆÙ‚Øª: <span id="quizTimer">00:00</span></div>
      </div>
      <div class="quiz-question" id="quizQuestionBox" aria-live="polite"></div>
      <div class="quiz-options" id="quizOptionsBox"></div>
      <div class="quiz-actions">
        <button class="big-btn" id="btnQuizSubmit"><i class="fas fa-paper-plane"></i> Ø¥Ø±Ø³Ø§Ù„</button>
        <button class="big-btn blue" id="btnQuizSpeak"><i class="fas fa-volume-up"></i> Ù†Ø·Ù‚ Ø§Ù„Ø³Ø¤Ø§Ù„</button>
        <button class="big-btn gray" id="btnQuizRestart"><i class="fas fa-rotate-left"></i> Ø¥Ø¹Ø§Ø¯Ø©</button>
      </div>
      <div class="score-chip"><i class="fas fa-percentage"></i> Ù†ØªÙŠØ¬Ø© Ù…Ø¤Ù‚ØªØ©: <span id="quizScoreTemp">0</span></div>
      <div class="quiz-results" id="quizResultsBox" aria-live="polite"></div>
    </div>
  </section>

</main>

<div class="audio-loading" id="audioLoading">
  <div class="spinner"></div>
  <div>Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø§Ù„ØµÙˆØª...</div>
</div>

<footer class="footer">
  <div class="container">
    &copy; 2025 Ù…Ù†ØµØ© frenhapeau Ø§Ù„ØªÙØ§Ø¹Ù„ÙŠØ© Ù„ØªØ¹Ù„ÙŠÙ… Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©| Ø¥ØµØ¯Ø§Ø± Ù…ØªÙƒØ§Ù…Ù„ | ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù‡Ø°Ù‡ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ù„ØºØ±Ø¶ Ø§Ù„ØªØ¹Ù„Ù… ÙˆØ§Ù„Ø¯Ø±Ø§Ø³Ø©. 
    <br>ÙŠÙ…ÙƒÙ†Ùƒ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙ‡ÙŠØ¦Ø© ÙÙŠ Ø£ÙŠ ÙˆÙ‚Øª Ù…Ù† Ø®Ù„Ø§Ù„ Ø²Ø± (Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· Ø§Ù„ØªÙ‚Ø¯Ù…).
  </div>
</footer>

<!-- Ø³ÙƒØ±Ø¨Øª Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„ÙƒØ§Ù…Ù„ -->
<script>
/* ====================== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø£Ø³Ø§Ø³ÙŠØ© ====================== */
const vocabularyData={
  places:[
    {f:'le stade',a:'Ø§Ù„Ù…Ù„Ø¹Ø¨ Ø§Ù„ÙƒØ¨ÙŠØ±',p:'Ù„ÙÙˆ Ø³Ù’ØªÙØ§Ø¯',c:'Ù…ÙƒØ§Ù† Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… ÙˆØ§Ù„Ø£Ù„Ø¹Ø§Ø¨ Ø§Ù„ÙƒØ¨Ø±Ù‰'},
    {f:'le gymnase',a:'Ø§Ù„ØµØ§Ù„Ø© Ø§Ù„Ø±ÙŠØ§Ø¶ÙŠØ©',p:'Ù„ÙÙˆ Ø¬ÙÙ…Ù’Ù†ÙØ§Ø²',c:'Ù‚Ø§Ø¹Ø© Ù…ØºÙ„Ù‚Ø© Ù„Ù„Ø±ÙŠØ§Ø¶Ø§Øª'},
    {f:'la piscine',a:'Ø­Ù…Ø§Ù… Ø§Ù„Ø³Ø¨Ø§Ø­Ø©',p:'Ù„ÙØ§ Ø¨ÙŠØ³ÙÙŠÙ†',c:'Ù…ÙƒØ§Ù† Ù…Ù…Ø§Ø±Ø³Ø© Ø§Ù„Ø³Ø¨Ø§Ø­Ø©'},
    {f:'le court',a:'Ù…Ù„Ø¹Ø¨ Ø§Ù„ØªÙ†Ø³',p:'Ù„ÙÙˆ ÙƒÙÙˆØ±',c:'Ù…Ø³Ø§Ø­Ø© Ù„Ù…Ø¨Ø§Ø±ÙŠØ§Øª Ø§Ù„ØªÙ†Ø³'},
    {f:'la piste',a:'Ø§Ù„Ù…Ø¶Ù…Ø§Ø±',p:'Ù„ÙØ§ Ø¨ÙŠØ³Ù’Øª',c:'Ù…Ø³Ø§Ø± Ø§Ù„Ø¬Ø±ÙŠ ÙˆØ£Ù„Ø¹Ø§Ø¨ Ø§Ù„Ù‚ÙˆÙ‰'},
    {f:'le terrain',a:'Ø£Ø±Ø¶ÙŠØ© Ø§Ù„Ù…Ù„Ø¹Ø¨',p:'Ù„ÙÙˆ ØªÙØ±ÙÙ‘Ø§Ù†',c:'Ø§Ù„Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù…Ø®ØµØµØ© Ù„Ù„Ø¹Ø¨'}
  ],
  people:[
    {f:'un joueur',a:'Ù„Ø§Ø¹Ø¨',p:'Ø£ÙÙ†Ù’ Ø¬ÙÙˆÙŠØ±',c:'ÙŠÙ…Ø§Ø±Ø³ Ù„Ø¹Ø¨Ø©'},
    {f:'une joueuse',a:'Ù„Ø§Ø¹Ø¨Ø©',p:'Ø£ÙÙˆÙ† Ø¬ÙÙˆÙŠÙÙˆØ²',c:'Ù„Ø§Ø¹Ø¨Ø© Ø±ÙŠØ§Ø¶ÙŠØ©'},
    {f:'un entraÃ®neur',a:'Ù…Ø¯Ø±Ø¨',p:'Ø£ÙÙ†Ù’ Ø£ÙÙ†Ù’ØªØ±ÙÙŠÙ†ÙŠØ±',c:'ÙŠØ´Ø±Ù Ø¹Ù„Ù‰ Ø§Ù„ÙØ±ÙŠÙ‚'},
    {f:'un arbitre',a:'Ø­ÙƒÙ…',p:'Ø£ÙÙ†Ù’ Ø£ÙØ±Ù’Ø¨ÙŠØªØ±',c:'ÙŠØ¯ÙŠØ± Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©'},
    {f:'une Ã©quipe',a:'ÙØ±ÙŠÙ‚',p:'Ø£ÙÙˆÙ† Ø¥ÙŠÙƒÙŠØ¨',c:'Ù…Ø¬Ù…ÙˆØ¹Ø© Ù„Ø§Ø¹Ø¨ÙŠÙ†'},
    {f:'un gardien de but',a:'Ø­Ø§Ø±Ø³ Ø§Ù„Ù…Ø±Ù…Ù‰',p:'Ø£ÙÙ†Ù’ Ø¬ÙØ§Ø±Ù’Ø¯ÙŠÙÙ†Ù’ Ø¯ÙÙˆ Ø¨ÙÙˆ',c:'ÙŠØ­Ù…ÙŠ Ø§Ù„Ù…Ø±Ù…Ù‰'}
  ],
  equipment:[
    {f:'un ballon',a:'ÙƒØ±Ø© (ÙƒØ¨ÙŠØ±Ø©)',p:'Ø£ÙÙ†Ù’ Ø¨ÙØ§Ù„ÙÙˆÙ†Ù’',c:'ÙƒØ±Ø© Ù‚Ø¯Ù… Ø£Ùˆ Ø³Ù„Ø©'},
    {f:'une balle',a:'ÙƒØ±Ø© (ØµØºÙŠØ±Ø©)',p:'Ø£ÙÙˆÙ† Ø¨ÙØ§Ù„',c:'ÙƒØ±Ø© Ø§Ù„ØªÙ†Ø³ Ø£Ùˆ Ø§Ù„Ø·Ø§ÙˆÙ„Ø©'},
    {f:'un filet',a:'Ø´Ø¨ÙƒØ©',p:'Ø£ÙÙ†Ù’ ÙÙŠÙ„ÙÙŠ',c:'ØªÙØµÙ„ Ù†ØµÙ Ø§Ù„Ù…Ù„Ø¹Ø¨'},
    {f:'des chaussures de sport',a:'Ø£Ø­Ø°ÙŠØ© Ø±ÙŠØ§Ø¶ÙŠØ©',p:'Ø´ÙÙˆØ³ÙÙˆØ± Ø¯Ù Ø³Ù’Ø¨ÙÙˆØ±',c:'Ø£Ø­Ø°ÙŠØ© Ø®Ø§ØµØ© Ù„Ù„Ø±ÙŠØ§Ø¶Ø©'},
    {f:'un maillot',a:'Ù‚Ù…ÙŠØµ Ø±ÙŠØ§Ø¶ÙŠ',p:'Ø£ÙÙ†Ù’ Ù…ÙØ§ÙŠÙÙˆ',c:'Ø§Ù„Ø²ÙŠ Ø§Ù„Ø±Ø³Ù…ÙŠ'}
  ],
  sports:[
    {f:'le football',a:'ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…',p:'ÙÙˆØªÙ’Ø¨ÙÙˆÙ„',c:'Ø§Ù„Ø£ÙƒØ«Ø± Ø§Ù†ØªØ´Ø§Ø±Ø§Ù‹'},
    {f:'le tennis',a:'Ø§Ù„ØªÙ†Ø³',p:'ØªÙÙ†ÙŠØ³',c:'Ø±ÙŠØ§Ø¶Ø© Ø§Ù„Ù…Ø¶Ø±Ø¨'},
    {f:'la natation',a:'Ø§Ù„Ø³Ø¨Ø§Ø­Ø©',p:'Ù†ÙØ§ØªÙØ§Ø³Ù’ÙŠÙÙˆÙ†',c:'Ø±ÙŠØ§Ø¶Ø© Ù…Ø§Ø¦ÙŠØ©'},
    {f:'le basketball',a:'ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø©',p:'Ø¨ÙØ§Ø³Ù’ÙƒÙØªÙ’Ø¨ÙÙˆÙ„',c:'ØªÙÙ„Ø¹Ø¨ Ø¨Ø§Ù„Ø³Ù„Ø©'},
    {f:'le volleyball',a:'Ø§Ù„ÙƒØ±Ø© Ø§Ù„Ø·Ø§Ø¦Ø±Ø©',p:'ÙÙÙˆÙ„ÙÙŠØ¨ÙÙˆÙ„',c:'Ø´Ø¨ÙƒØ© Ù…Ø±ØªÙØ¹Ø©'},
    {f:'le judo',a:'Ø§Ù„Ø¬ÙˆØ¯Ùˆ',p:'Ø¬ÙÙˆØ¯ÙÙˆ',c:'ÙÙ† Ù‚ØªØ§Ù„ÙŠ ÙŠØ§Ø¨Ø§Ù†ÙŠ'}
  ],
  actions:[
    {f:'courir',a:'ÙŠØ¬Ø±ÙŠ',p:'ÙƒÙÙˆØ±ÙŠØ±',c:'Ø§Ù„ØªØ­Ø±Ùƒ Ø¨Ø³Ø±Ø¹Ø©'},
    {f:'sauter',a:'ÙŠÙ‚ÙØ²',p:'Ø³ÙÙˆØªÙÙŠ',c:'Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø¹Ù† Ø§Ù„Ø£Ø±Ø¶'},
    {f:'lancer',a:'ÙŠØ±Ù…ÙŠ',p:'Ù„ÙØ§Ù†Ù’Ø³ÙÙŠ',c:'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„ÙƒØ±Ø©'},
    {f:'nager',a:'ÙŠØ³Ø¨Ø­',p:'Ù†ÙØ§Ø¬ÙÙŠ',c:'Ø§Ù„Ø­Ø±ÙƒØ© ÙÙŠ Ø§Ù„Ù…Ø§Ø¡'},
    {f:'gagner',a:'ÙŠÙÙˆØ²',p:'Ø¬ÙØ§Ù†Ù’ÙŠÙÙŠ',c:'ØªØ­Ù‚ÙŠÙ‚ Ø§Ù„Ù†ØµØ±'},
    {f:'perdre',a:'ÙŠØ®Ø³Ø±',p:'Ø¨ÙÙŠØ±Ù’Ø¯Ø±',c:'Ø¹Ø¯Ù… Ø§Ù„ÙÙˆØ²'}
  ]
};

const phrasesData={
  asking:[
    {fr:"Quel sport fais-tu?",ar:"Ù…Ø§ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© Ø§Ù„ØªÙŠ ØªÙ…Ø§Ø±Ø³Ù‡Ø§ØŸ",pr:"ÙƒÙÙ„ Ø³Ù’Ø¨ÙÙˆØ± ÙÙÙŠ ØªÙÙˆØŸ",ctx:"Ø³Ø¤Ø§Ù„ Ø¹Ø§Ù…"},
    {fr:"Tu joues au football?",ar:"Ù‡Ù„ ØªÙ„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…ØŸ",pr:"ØªÙÙˆ Ø¬ÙÙˆ Ø£ÙÙˆ ÙÙˆØªØ¨ÙˆÙ„ØŸ",ctx:"Ø³Ø¤Ø§Ù„ ØªØ£ÙƒÙŠØ¯ÙŠ"},
    {fr:"OÃ¹ t'entraÃ®nes-tu?",ar:"Ø£ÙŠÙ† ØªØªØ¯Ø±Ø¨ØŸ",pr:"Ø£ÙÙˆ ØªÙØ§Ù†ØªØ±ÙÙŠÙ† ØªÙÙˆØŸ",ctx:"Ù…ÙƒØ§Ù† Ø§Ù„ØªØ¯Ø±ÙŠØ¨"},
    {fr:"Combien de fois par semaine?",ar:"ÙƒÙ… Ù…Ø±Ø© Ø£Ø³Ø¨ÙˆØ¹ÙŠØ§Ù‹ØŸ",pr:"ÙƒÙÙˆÙ…Ù’Ø¨Ù’ÙŠÙØ§Ù† Ø¯Ù ÙÙ’ÙˆÙØ§ØŸ",ctx:"Ø§Ù„ØªÙƒØ±Ø§Ø±"}
  ],
  describing:[
    {fr:"Je fais du sport tous les jours",ar:"Ø£Ù…Ø§Ø±Ø³ Ø§Ù„Ø±ÙŠØ§Ø¶Ø© ÙƒÙ„ ÙŠÙˆÙ…",pr:"Ø¬ÙÙˆ ÙÙÙŠ Ø¯Ù Ø³Ù’Ø¨ÙÙˆØ± ØªÙÙˆ Ù„ÙÙŠ Ø¬ÙÙˆØ±",ctx:"Ø±ÙˆØªÙŠÙ†"},
    {fr:"Mon Ã©quipe s'entraÃ®ne le soir",ar:"ÙØ±ÙŠÙ‚ÙŠ ÙŠØªØ¯Ø±Ø¨ Ù…Ø³Ø§Ø¡Ù‹",pr:"Ù…ÙÙˆÙ† Ø¥ÙŠÙƒÙÙŠØ¨ Ø³ÙØ§Ù†ØªØ±ÙÙŠÙ† Ù„ÙÙˆ Ø³Ù’ÙˆÙØ§Ø±",ctx:"ÙˆÙ‚Øª Ø§Ù„ØªØ¯Ø±ÙŠØ¨"},
    {fr:"Le match Ã©tait fantastique",ar:"ÙƒØ§Ù†Øª Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø© Ø±Ø§Ø¦Ø¹Ø©",pr:"Ù„ÙÙˆ Ù…ÙØ§ØªÙ’Ø´ Ø¥ÙŠØªÙÙŠ ÙÙØ§Ù†Ù’ØªÙØ§Ø³Ù’ØªÙŠÙƒ",ctx:"ÙˆØµÙ"},
    {fr:"Je progresse chaque semaine",ar:"Ø£ØªÙ‚Ø¯Ù… ÙƒÙ„ Ø£Ø³Ø¨ÙˆØ¹",pr:"Ø¬ÙÙˆ Ø¨Ù’Ø±ÙÙˆØºÙ’Ø±ÙÙŠØ³ Ø´ÙØ§Ùƒ Ø³ÙÙˆÙ…ÙÙŠÙ†",ctx:"ØªØ·ÙˆØ±"}
  ],
  expressing:[
    {fr:"J'adore le tennis",ar:"Ø£Ø­Ø¨ Ø§Ù„ØªÙ†Ø³",pr:"Ø¬ÙØ§Ø¯ÙÙˆØ± Ù„ÙÙˆ ØªÙÙ†ÙŠØ³",ctx:"Ø¥Ø¹Ø¬Ø§Ø¨"},
    {fr:"Le football est ma passion",ar:"ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ù‡ÙŠ Ø´ØºÙÙŠ",pr:"Ù„ÙÙˆ ÙÙÙˆØªÙ’Ø¨ÙÙˆÙ„ Ø¥ÙÙ‡ Ù…ÙØ§ Ø¨ÙØ§Ø³Ù’ÙŠÙÙˆÙ†",ctx:"Ø´ØºÙ"},
    {fr:"Je dÃ©teste perdre",ar:"Ø£ÙƒØ±Ù‡ Ø§Ù„Ø®Ø³Ø§Ø±Ø©",pr:"Ø¬ÙÙˆ Ø¯ÙÙŠØªÙØ³Øª Ø¨ÙÙŠØ±Ù’Ø¯Ø±",ctx:"Ø±ÙØ¶"},
    {fr:"C'est difficile mais amusant",ar:"Ø¥Ù†Ù‡ ØµØ¹Ø¨ Ù„ÙƒÙ†Ù‡ Ù…Ù…ØªØ¹",pr:"Ø³ÙÙŠ Ø¯ÙÙŠÙÙÙŠØ³ÙŠÙ„ Ù…ÙÙŠ Ø£ÙÙ…ÙÙˆØ²ÙØ§Ù†",ctx:"ØªÙˆØ§Ø²Ù†"}
  ],
  conversation:[
    {fr:"Tu veux jouer avec nous?",ar:"Ù‡Ù„ ØªØ±ÙŠØ¯ Ø§Ù„Ù„Ø¹Ø¨ Ù…Ø¹Ù†Ø§ØŸ",pr:"ØªÙÙˆ ÙÙÙˆ Ø¬ÙÙˆÙÙŠ Ø£ÙÙÙÙŠÙƒ Ù†ÙÙˆ",ctx:"Ø¯Ø¹ÙˆØ©"},
    {fr:"Bonne chance pour le match!",ar:"Ø­Ø¸ Ù…ÙˆÙÙ‚ ÙÙŠ Ø§Ù„Ù…Ø¨Ø§Ø±Ø§Ø©!",pr:"Ø¨ÙÙˆÙ† Ø´ÙØ§Ù†Ù’Ø³ Ø¨ÙÙˆØ± Ù„ÙÙˆ Ù…ÙØ§ØªÙ’Ø´",ctx:"ØªØ´Ø¬ÙŠØ¹"},
    {fr:"FÃ©licitations pour la victoire!",ar:"Ù…Ø¨Ø±ÙˆÙƒ Ø§Ù„ÙÙˆØ²!",pr:"ÙÙÙŠÙ„ÙŠØ³ÙÙŠØªÙØ§Ø³Ù’ÙŠÙÙˆÙ† Ø¨ÙÙˆØ± Ù„ÙØ§ ÙÙÙŠÙƒÙ’ØªÙÙˆÙØ§Ø±",ctx:"ØªÙ‡Ù†Ø¦Ø©"},
    {fr:"Tu peux recommencer demain",ar:"ÙŠÙ…ÙƒÙ†Ùƒ Ø£Ù† ØªØ¹ÙŠØ¯ ØºØ¯Ø§Ù‹",pr:"ØªÙÙˆ Ø¨ÙÙˆ Ø±ÙÙƒÙÙˆÙ…ÙØ§Ù†Ø³ÙŠ Ø¯ÙÙˆÙ…ÙØ§Ù†",ctx:"Ù†ØµÙŠØ­Ø©"}
  ]
};

const fillExercises=[
  {
    sentence:"Je _____ du tennis avec mes amis.",
    answer:"joue",
    options:["joue","fais","mange"],
    trans:"Ø£Ù†Ø§ Ø£Ù„Ø¹Ø¨ Ø§Ù„ØªÙ†Ø³ Ù…Ø¹ Ø£ØµØ¯Ù‚Ø§Ø¦ÙŠ",
    hint:"Ø§Ù„ØªÙ†Ø³ = Ù„Ø¹Ø¨Ø© Ø¨Ø§Ù„Ù…Ø¶Ø±Ø¨ â‡’ jouer",
    explain:"Ù†Ø³ØªØ®Ø¯Ù… jouer Ù…Ø¹ Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª Ø¨Ø§Ù„ÙƒØ±Ø©/Ø§Ù„Ù…Ø¶Ø±Ø¨ Ù…Ø«Ù„ tennis"
  },
  {
    sentence:"Elle _____ de la natation Ã  la piscine.",
    answer:"fait",
    options:["fait","joue","va"],
    trans:"Ù‡ÙŠ ØªÙ…Ø§Ø±Ø³ Ø§Ù„Ø³Ø¨Ø§Ø­Ø© ÙÙŠ Ø§Ù„Ù…Ø³Ø¨Ø­",
    hint:"natation Ø±ÙŠØ§Ø¶Ø© ÙØ±Ø¯ÙŠØ© â‡’ faire",
    explain:"Ø§Ù„Ø³Ø¨Ø§Ø­Ø© Ù†Ø´Ø§Ø· ÙØ±Ø¯ÙŠ Ù„Ø°Ø§ faire"
  },
  {
    sentence:"Nous _____ au football au stade.",
    answer:"jouons",
    options:["jouons","faisons","mangeons"],
    trans:"Ù†Ø­Ù† Ù†Ù„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… ÙÙŠ Ø§Ù„Ù…Ù„Ø¹Ø¨",
    hint:"football Ø¨Ø§Ù„ÙƒØ±Ø© â‡’ jouer",
    explain:"ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù… Ù„Ø¹Ø¨Ø© Ø¬Ù…Ø§Ø¹ÙŠØ© Ø¨Ø§Ù„ÙƒØ±Ø©"
  },
  {
    sentence:"Tu _____ du vÃ©lo dans le parc ?",
    answer:"fais",
    options:["fais","joues","vas"],
    trans:"Ù‡Ù„ ØªÙ‚ÙˆØ¯ Ø§Ù„Ø¯Ø±Ø§Ø¬Ø© ÙÙŠ Ø§Ù„Ø­Ø¯ÙŠÙ‚Ø©ØŸ",
    hint:"vÃ©lo Ù†Ø´Ø§Ø· ÙØ±Ø¯ÙŠ â‡’ faire",
    explain:"Ø±ÙƒÙˆØ¨ Ø§Ù„Ø¯Ø±Ø§Ø¬Ø© Ù†Ø´Ø§Ø· ÙØ±Ø¯ÙŠ"
  },
  {
    sentence:"Les enfants _____ au basketball.",
    answer:"jouent",
    options:["jouent","font","vont"],
    trans:"Ø§Ù„Ø£Ø·ÙØ§Ù„ ÙŠÙ„Ø¹Ø¨ÙˆÙ† ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø©",
    hint:"basketball ÙƒØ±Ø© â‡’ jouer",
    explain:"Ø±ÙŠØ§Ø¶Ø© Ø¨Ø§Ù„ÙƒØ±Ø© â‡’ jouer"
  }
];

const dragDropData={
  words:["au","de la","du","Ã  la"],
  sentences:[
    {tmpl:"Je joue ___ football.",ans:"au",trans:"Ø£Ù†Ø§ Ø£Ù„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…"},
    {tmpl:"Elle fait ___ natation.",ans:"de la",trans:"Ù‡ÙŠ ØªÙ…Ø§Ø±Ø³ Ø§Ù„Ø³Ø¨Ø§Ø­Ø©"},
    {tmpl:"Tu fais ___ judo.",ans:"du",trans:"Ø£Ù†Øª ØªÙ…Ø§Ø±Ø³ Ø§Ù„Ø¬ÙˆØ¯Ùˆ"},
    {tmpl:"Nous jouons ___ pÃ©tanque.",ans:"Ã  la",trans:"Ù†Ø­Ù† Ù†Ù„Ø¹Ø¨ Ø§Ù„Ø¨ÙŠØªØ§Ù†Ùƒ"}
  ]
};

const pronunciationData={
  word:[
    {fr:"football",ar:"ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…",phon:"ÙÙˆØªÙ’Ø¨ÙÙˆÙ„",tip:"Ø­Ø±Ù t Ù„Ø§ ÙŠÙÙ†Ø·Ù‚ ÙÙŠ Ø§Ù„Ù†Ù‡Ø§ÙŠØ§Øª ØºØ§Ù„Ø¨Ø§Ù‹."},
    {fr:"tennis",ar:"Ø§Ù„ØªÙ†Ø³",phon:"ØªÙÙ†ÙŠØ³",tip:"Ø§Ù„Ù€ e Ø®ÙÙŠÙØ© Ø£Ù‚Ø±Ø¨ (Ø¥Ù)."},
    {fr:"natation",ar:"Ø§Ù„Ø³Ø¨Ø§Ø­Ø©",phon:"Ù†Ø§ØªØ§Ø³Ù’ÙŠÙÙˆÙ†",tip:"Ø§Ù„Ù†Ù‡Ø§ÙŠØ© tion ØªÙÙ†Ø·Ù‚ (Ø³Ù’ÙŠÙÙˆÙ†)."},
    {fr:"basketball",ar:"ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø©",phon:"Ø¨ÙØ§Ø³Ù’ÙƒÙØªÙ’Ø¨ÙÙˆÙ„",tip:"Ø§Ù†Ø·Ù‚ basket + Ø¨ÙˆÙ„ Ù…Ø¹ ØªØ®ÙÙŠÙ t."},
    {fr:"judo",ar:"Ø§Ù„Ø¬ÙˆØ¯Ùˆ",phon:"Ø¬ÙÙˆØ¯ÙÙˆ",tip:"Ø­Ø±Ù j ÙØ±Ù†Ø³ÙŠ = Ø¬ Ù†Ø§Ø¹Ù…Ø©."}
  ],
  sentence:[
    {fr:"Je fais du sport",ar:"Ø£Ù†Ø§ Ø£Ù…Ø§Ø±Ø³ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©",phon:"Ø¬ÙÙˆ ÙÙÙŠ Ø¯Ù Ø³Ù’Ø¨ÙÙˆØ±",tip:"Ø§Ø±Ø¨Ø· fais du Ø¨Ø·Ø±ÙŠÙ‚Ø© Ø³Ù„Ø³Ø©."},
    {fr:"Elle joue au tennis",ar:"Ù‡ÙŠ ØªÙ„Ø¹Ø¨ Ø§Ù„ØªÙ†Ø³",phon:"Ø¥ÙÙ„ Ø¬ÙÙˆ Ø£ÙÙˆ ØªÙÙ†ÙŠØ³",tip:"au + tennis = Ø£ÙÙˆØªÙÙ†ÙŠØ³ Ù…ØªØµÙ„Ø©."},
    {fr:"Nous jouons au football",ar:"Ù†Ø­Ù† Ù†Ù„Ø¹Ø¨ ÙƒØ±Ø© Ø§Ù„Ù‚Ø¯Ù…",phon:"Ù†ÙÙˆ Ø¬ÙÙˆ Ø£ÙÙˆ ÙÙˆØªØ¨ÙˆÙ„",tip:"jouons: (Ø¬ÙˆÙˆÙ†Øº) Ø¨Ø¯ÙˆÙ† Ù†Ø·Ù‚ ÙˆØ§Ø¶Ø­ g."}
  ],
  dialogue:[
    {fr:"- Quel sport fais-tu?\n- Je fais du judo.",ar:"- Ù…Ø§ Ø§Ù„Ø±ÙŠØ§Ø¶Ø©ØŸ\n- Ø£Ù…Ø§Ø±Ø³ Ø§Ù„Ø¬ÙˆØ¯Ùˆ.",phon:"- ÙƒÙÙ„ Ø³Ù’Ø¨ÙÙˆØ± ÙÙÙŠ ØªÙÙˆØŸ\n- Ø¬ÙÙˆ ÙÙÙŠ Ø¯Ù Ø¬ÙÙˆØ¯ÙÙˆ.",tip:"ØºÙŠÙ‘Ø± Ù†Ø¨Ø±Ø© Ø§Ù„Ø³Ø¤Ø§Ù„ Ø«Ù… Ø£Ø®ÙØ¶ Ù„Ù„Ø¬ÙˆØ§Ø¨."},
    {fr:"- Tu joues au tennis?\n- Oui, j'adore Ã§a.",ar:"- Ù‡Ù„ ØªÙ„Ø¹Ø¨ Ø§Ù„ØªÙ†Ø³ØŸ\n- Ù†Ø¹Ù… Ø£Ø­Ø¨Ù‡.",phon:"- ØªÙÙˆ Ø¬ÙÙˆ Ø£ÙÙˆ ØªÙÙ†ÙŠØ³ØŸ\n- ÙˆÙÙŠØŒ Ø¬ÙØ§Ø¯ÙÙˆØ± Ø³ÙØ§.",tip:"Ø§Ù„Ø¬Ù…Ù„Ø© Ø§Ù„Ø«Ø§Ù†ÙŠØ© Ø¨Ø³Ù„Ø§Ø³Ø© Ø¨Ù„Ø§ ØªÙˆÙ‚Ù."}
  ]
};

const quizQuestions=[
  {
    q:"Ø§Ù„ØµÙŠØºØ© Ø§Ù„ØµØ­ÙŠØ­Ø©: (Ø£Ù†Ø§ Ø£Ù…Ø§Ø±Ø³ Ø§Ù„Ø³Ø¨Ø§Ø­Ø©).",
    options:["Je joue de la natation","Je fais de la natation","Je vais de la natation","Je mange de la natation"],
    ans:1,
    exp:"Ø§Ù„Ø³Ø¨Ø§Ø­Ø© Ø±ÙŠØ§Ø¶Ø© ÙØ±Ø¯ÙŠØ© â‡’ faire"
  },
  {
    q:"Ù†Ø³ØªØ®Ø¯Ù… jouer Ù…Ø¹:",
    options:["Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª Ø§Ù„ÙØ±Ø¯ÙŠØ© Ø¨Ù„Ø§ Ø£Ø¯ÙˆØ§Øª","Ø§Ù„Ø±ÙŠØ§Ø¶Ø§Øª Ø¨Ø§Ù„ÙƒØ±Ø©","Ø§Ù„Ø·Ø¹Ø§Ù…","Ø§Ù„Ø£Ø³Ù…Ø§Ø¡ ÙÙ‚Ø·"],
    ans:1,
    exp:"ÙƒØ±Ø© / Ù„Ø¹Ø¨Ø© Ø¬Ù…Ø§Ø¹ÙŠØ© = jouer"
  },
  {
    q:"Ø§Ù„Ø£Ø¯Ø§Ø© Ø§Ù„ØµØ­ÙŠØ­Ø© Ù…Ø¹ (football) Ø¨Ø¹Ø¯ jouer:",
    options:["du","de la","au","Ã  la"],
    ans:2,
    exp:"football Ù…Ø°ÙƒØ± â‡’ au"
  },
  {
    q:"Ø§Ù„ØµØ­ÙŠØ­: (Ù†Ø­Ù† Ù†Ù„Ø¹Ø¨ Ø§Ù„Ø¬ÙˆØ¯Ùˆ)ØŸ",
    options:["Nous jouons au judo","Nous faisons du judo","Nous jouons du judo","Nous jouons de la judo"],
    ans:1,
    exp:"Ø§Ù„Ø¬ÙˆØ¯Ùˆ Ø±ÙŠØ§Ø¶Ø© ÙØ±Ø¯ÙŠØ© â‡’ faire du"
  },
  {
    q:"(Ù‡Ù… ÙŠÙ„Ø¹Ø¨ÙˆÙ† ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø©) Ø¨Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©:",
    options:["Ils font du basketball","Ils jouent au basketball","Ils jouent du basketball","Ils vont au basketball"],
    ans:1,
    exp:"ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø© â‡’ jouer au"
  },
  {
    q:"Ø§Ø®ØªÙŠØ§Ø± ØµØ­ÙŠØ­: Elle ____ du vÃ©lo.",
    options:["joue","fait","fais","jouent"],
    ans:1,
    exp:"vÃ©lo Ù†Ø´Ø§Ø· ÙØ±Ø¯ÙŠ â‡’ Elle fait"
  },
  {
    q:"Ø£Ø¯Ø§Ø© judo Ù…Ø¹ faire:",
    options:["du","au","de la","Ã  la"],
    ans:0,
    exp:"Ø±ÙŠØ§Ø¶Ø© Ù…Ø°ÙƒØ± ØªØ¨Ø¯Ø£ Ø¨Ø­Ø±Ù Ø³Ø§ÙƒÙ† â‡’ du"
  },
  {
    q:"Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØµØ­ÙŠØ­ Ù„ÙƒÙ„Ù…Ø© (football) ÙÙŠ Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©:",
    options:["ÙÙˆØªÙÙŠØ¨Ø§Ù„","ÙÙˆØªÙ’Ø¨ÙˆÙ„ (t Ù„Ø§ ØªÙÙ†Ø·Ù‚)","ÙÙˆ ØªØ¨ÙˆÙ„ (Ø¨ØªÙ‚Ø·ÙŠØ¹)","ÙÙˆØªÙ Ø¨ÙˆÙ„ Ù…Ø¹ ÙØªØ­ Ø§Ù„ØªØ§Ø¡"],
    ans:1,
    exp:"t ØµØ§Ù…Øª ØºØ§Ù„Ø¨Ø§Ù‹"
  },
  {
    q:"Ù†Ù‚ÙˆÙ„: Je ____ au tennis.",
    options:["fais","suis","joue","fait"],
    ans:2,
    exp:"Ø§Ù„ØªÙ†Ø³ Ù„Ø¹Ø¨Ø© Ø¨Ø§Ù„Ù…Ø¶Ø±Ø¨ â‡’ jouer"
  },
  {
    q:"Ø¬Ù…Ù„Ø© ØµØ­ÙŠØ­Ø©: (Ø£Ø­Ø¨ Ø§Ù„ÙÙˆØ²).",
    options:["J'adore gagner","Je fais gagner","Je joue gagner","Je suis gagner"],
    ans:0,
    exp:"Ø§Ù„ÙØ¹Ù„ gagner = ÙŠÙÙˆØ² â‡’ j'adore gagner"
  }
];

/* ====================== Ø§Ù„Ø­Ø§Ù„Ø© ÙˆØ§Ù„Ù…ØªØºÙŠØ±Ø§Øª ====================== */
let currentSection="grammar";
let vocabCategory="places";
let phraseCategory="asking";
let pronMode="word";
let pronIndex=0;
let pronCounters={word:0,sentence:0,dialogue:0};
let fillIndex=0;
let fillScore=0;
let dragEvaluated=false;
let dragScore=0;
let quizIndex=0;
let quizScore=0;
let quizSelected=null;
let quizTimer=0;
let quizTimerInterval=null;
let sessionSeconds=0;
let sessionTimerInterval=null;
let medalGiven=false;
let voicesLoaded=false;
let frVoice=null, arVoice=null;
let savedStateLoaded=false;

/* ====================== Ø¹Ù†Ø§ØµØ± DOM Ù…Ø³Ø§Ø¹Ø¯Ø© ====================== */
const el=(s,ctx=document)=>ctx.querySelector(s);
const els=(s,ctx=document)=>[...ctx.querySelectorAll(s)];

/* ====================== ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„ØªØºØ°ÙŠØ© Ø§Ù„Ø±Ø§Ø¬Ø¹Ø© ====================== */
function showFeedback(msg,type="info",timeout=3500){
  const old=el('.feedback'); if(old){old.remove();}
  const div=document.createElement('div');
  div.className=`feedback ${type}`;
  div.innerHTML=`<i class="fas ${
    type==="success"?"fa-check-circle":
    type==="error"?"fa-times-circle":
    type==="warning"?"fa-exclamation-triangle":
    "fa-info-circle"
  }"></i> ${msg}`;
  document.body.appendChild(div);
  setTimeout(()=>{
    div.style.animation='slideOut .45s forwards';
    setTimeout(()=>div.remove(),450);
  },timeout);
}

/* ====================== Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ‚Ø¯Ù… Ø§Ù„Ø¹Ø§Ù… ====================== */
function updateGlobalProgressBar(){
  const totalFill=fillExercises.length;
  const fillDone= Math.min(fillIndex, totalFill);
  const totalDrag=dragDropData.sentences.length;
  const dragDone=dragEvaluated?totalDrag:0;
  const totalQuiz=quizQuestions.length;
  const quizDone=Math.min(quizIndex, totalQuiz);
  const totalPron = pronunciationData.word.length+pronunciationData.sentence.length+pronunciationData.dialogue.length;
  const pronDone = pronCounters.word+pronCounters.sentence+pronCounters.dialogue;

  const overallPercent=Math.round(((fillDone+dragDone+quizDone+pronDone)/(totalFill+totalDrag+totalQuiz+totalPron))*100);

  el('#globalProgressFill').style.width=overallPercent+'%';
  el('#engagementLevel').textContent=overallPercent+'%';

  el('#statFill').textContent=`${fillDone}/${totalFill}`;
  el('#statDrag').textContent=`${dragDone}/${totalDrag}`;
  el('#statQuiz').textContent=`${quizDone}/${totalQuiz}`;
  el('#statPron').textContent=`${pronDone}/${totalPron}`;

  if(overallPercent>=80 && !medalGiven){
    medalGiven=true;
    showFeedback('ğŸ¥‡ Ù…Ø¨Ø±ÙˆÙƒ! Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ù…ÙŠØ¯Ø§Ù„ÙŠØ© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø² (80%)','success',5000);
    saveState();
  }
}

/* ====================== Ø­ÙØ¸ / ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø­Ø§Ù„Ø© ====================== */
function saveState(){
  try{
    const state={
      fillIndex,fillScore,dragEvaluated,dragScore,
      quizIndex,quizScore,quizTimer,
      pronMode,pronIndex,pronCounters,
      vocabCategory,phraseCategory,
      medalGiven
    };
    localStorage.setItem('fr_sport_state',JSON.stringify(state));
  }catch(e){console.warn('Ø­ÙØ¸ ÙØ´Ù„',e);}
}
function loadState(){
  try{
    const raw=localStorage.getItem('fr_sport_state');
    if(!raw) return;
    const s=JSON.parse(raw);
    fillIndex=s.fillIndex||0;
    fillScore=s.fillScore||0;
    dragEvaluated=s.dragEvaluated||false;
    dragScore=s.dragScore||0;
    quizIndex=s.quizIndex||0;
    quizScore=s.quizScore||0;
    quizTimer=s.quizTimer||0;
    pronMode=s.pronMode||'word';
    pronIndex=s.pronIndex||0;
    pronCounters=s.pronCounters||{word:0,sentence:0,dialogue:0};
    vocabCategory=s.vocabCategory||"places";
    phraseCategory=s.phraseCategory||"asking";
    medalGiven=!!s.medalGiven;
    savedStateLoaded=true;
  }catch(e){console.warn('ØªØ­Ù…ÙŠÙ„ ÙØ´Ù„',e);}
}
function resetAllProgress(){
  if(!confirm('Ù‡Ù„ Ø£Ù†Øª Ù…ØªØ£ÙƒØ¯ Ù…Ù† Ø¥Ø¹Ø§Ø¯Ø© Ø¶Ø¨Ø· ÙƒÙ„ Ø§Ù„ØªÙ‚Ø¯Ù…ØŸ')) return;
  localStorage.removeItem('fr_sport_state');
  fillIndex=0; fillScore=0;
  dragEvaluated=false; dragScore=0;
  quizIndex=0; quizScore=0; quizTimer=0;
  pronMode='word'; pronIndex=0; pronCounters={word:0,sentence:0,dialogue:0};
  vocabCategory='places'; phraseCategory='asking';
  medalGiven=false;
  renderAllSections(true);
  showFeedback('ØªÙ…Øª Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø¶Ø¨Ø·','info');
  saveState();
}

/* ====================== Ø§Ù„Ù†Ø·Ù‚ ====================== */
function loadVoices(){
  const vs=speechSynthesis.getVoices();
  if(!vs.length) return;
  frVoice = vs.find(v=>v.lang==='fr-FR') || vs.find(v=>/fr/i.test(v.lang)) || null;
  arVoice = vs.find(v=>/ar/i.test(v.lang)) || null;
  voicesLoaded=true;
}
if('speechSynthesis' in window){
  speechSynthesis.onvoiceschanged=()=>{
    loadVoices();
  };
  setTimeout(loadVoices,600);
}

function speak(text,lang='fr-FR',btn=null,slow=false){
  if(!('speechSynthesis' in window)){
    showFeedback('Ø§Ù„Ù†Ø·Ù‚ ØºÙŠØ± Ù…Ø¯Ø¹ÙˆÙ… ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ù…ØªØµÙØ­','error');
    return;
  }
  text = (text||'').replace(/\s+/g,' ').trim();
  if(!text){return;}
  try{
    const u=new SpeechSynthesisUtterance(text);
    if(lang.startsWith('ar')){
      u.lang= arVoice? arVoice.lang : 'ar-SA';
      if(arVoice) u.voice=arVoice;
    }else{
      u.lang= frVoice? frVoice.lang : 'fr-FR';
      if(frVoice) u.voice=frVoice;
    }
    u.rate= slow ? 0.55 : 0.9;
    u.pitch=1;
    u.onstart=()=>{
      el('#audioLoading').style.display='flex';
      if(btn) btn.classList.add('playing');
    };
    u.onend=()=>{
      el('#audioLoading').style.display='none';
      if(btn) btn.classList.remove('playing');
    };
    u.onerror=()=>{
      el('#audioLoading').style.display='none';
      if(btn) btn.classList.remove('playing');
      showFeedback('Ø­Ø¯Ø« Ø®Ø·Ø£ ÙÙŠ ØªØ´ØºÙŠÙ„ Ø§Ù„ØµÙˆØª','error');
    };
    speechSynthesis.cancel();
    speechSynthesis.speak(u);
  }catch(err){
    showFeedback('ØªØ¹Ø°Ø± Ø§Ù„Ù†Ø·Ù‚','error');
  }
}

/* ====================== Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª ====================== */
function renderVocabulary(){
  els('.filter-btn[data-vcat]').forEach(b=>b.classList.toggle('active',b.dataset.vcat===vocabCategory));
  const search=el('#vocabSearch').value.trim().toLowerCase();
  const data=vocabularyData[vocabCategory]||[];
  const grid=el('#vocabGrid');
  grid.innerHTML=data.filter(item=>{
    if(!search) return true;
    return item.f.toLowerCase().includes(search)||item.a.toLowerCase().includes(search);
  }).map(item=>`
    <div class="vocab-card" data-vocab="${item.f}">
      <div class="vocab-front">
        <div class="vocab-term">${item.f}</div>
        <div class="vocab-pron">${item.p}</div>
        <div class="card-actions">
          <button class="sm-btn" data-say="${item.f}"><i class="fas fa-volume-up"></i> Ù†Ø·Ù‚</button>
          <button class="sm-btn outline" data-say="${item.f}" data-slow="1"><i class="fas fa-turtle"></i> Ø¨Ø·ÙŠØ¡</button>
          <button class="sm-btn outline" data-flip="${item.f}"><i class="fas fa-exchange-alt"></i> Ù‚Ù„Ø¨</button>
        </div>
      </div>
      <div class="vocab-back">
        <div class="vocab-ar">${item.a}</div>
        <div class="vocab-context">${item.c}</div>
        <div class="card-actions">
          <button class="sm-btn" data-say="${item.f}"><i class="fas fa-headphones"></i> Ø§Ø³ØªÙ…Ø§Ø¹</button>
          <button class="sm-btn outline" data-flip="${item.f}"><i class="fas fa-undo"></i> Ø±Ø¬ÙˆØ¹</button>
        </div>
      </div>
    </div>
  `).join('') || `<p style="font-size:.8rem;font-weight:600;color:#718096">Ù„Ø§ Ù†ØªØ§Ø¦Ø¬ Ù…Ø·Ø§Ø¨Ù‚Ø©...</p>`;
}

/* ====================== Ø§Ù„ØªØ¹Ø¨ÙŠØ±Ø§Øª ====================== */
function renderPhrases(){
  els('.filter-btn[data-pcat]').forEach(b=>b.classList.toggle('active',b.dataset.pcat===phraseCategory));
  const wrap=el('#phrasesWrapper');
  const arr=phrasesData[phraseCategory]||[];
  wrap.innerHTML=arr.map(p=>`
    <div class="phrase-item">
      <div class="phrase-context"><i class="fas fa-tag"></i> ${p.ctx}</div>
      <div class="phrase-fr">${p.fr}</div>
      <div class="phrase-ar">${p.ar}</div>
      <div class="inline-controls">
        <button class="sm-btn" data-say="${p.fr}"><i class="fas fa-volume-up"></i> ÙØ±Ù†Ø³ÙŠ</button>
        <button class="sm-btn outline" data-say="${p.ar}" data-lang="ar-SA"><i class="fas fa-volume-up"></i> Ø¹Ø±Ø¨ÙŠ</button>
        <button class="sm-btn outline" data-say="${p.fr}" data-slow="1"><i class="fas fa-turtle"></i> Ø¨Ø·ÙŠØ¡</button>
      </div>
      <div style="font-size:.6rem;color:#4299e1;font-weight:700;letter-spacing:.5px">Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ: ${p.pr}</div>
    </div>
  `).join('');
}

/* ====================== ØªØ¯Ø±ÙŠØ¨ Ø§Ù„Ù†Ø·Ù‚ ====================== */
function renderPronunciation(){
  els('.mode-btn').forEach(b=>b.classList.toggle('active',b.dataset.pmode===pronMode));
  const data=pronunciationData[pronMode];
  if(!data || !data.length){el('#pronContent').innerHTML="<p>Ù„Ø§ Ø¨ÙŠØ§Ù†Ø§Øª.</p>";return;}
  if(pronIndex>=data.length) pronIndex=0;
  const item=data[pronIndex];
  el('#pronContent').innerHTML=`
    <div class="pron-fr">${item.fr.replace(/\n/g,'<br>')}</div>
    <div class="pron-ar">${item.ar.replace(/\n/g,'<br>')}</div>
    <div class="pron-phon">Ø§Ù„Ù†Ø·Ù‚ Ø§Ù„ØªÙ‚Ø±ÙŠØ¨ÙŠ: ${item.phon}</div>
    <div class="pron-tip"><i class="fas fa-lightbulb"></i> ${item.tip}</div>
  `;
  const total= pronunciationData.word.length + pronunciationData.sentence.length + pronunciationData.dialogue.length;
  const done= pronCounters.word + pronCounters.sentence + pronCounters.dialogue;
  el('#pronCounter').textContent=`${done}/${total}`;
}

/* ====================== ØªÙ…Ø±ÙŠÙ† Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§Øº ====================== */
function renderFillExercise(){
  const box=el('#fillExerciseBox');
  if(fillIndex>=fillExercises.length){
    box.innerHTML=`
      <div class="fill-sentence" style="font-size:.95rem">Ø§Ù†ØªÙ‡Øª Ø§Ù„Ø£Ø³Ø¦Ù„Ø© âœ…</div>
      <div class="translation-line"><i class="fas fa-star"></i> Ù†ØªÙŠØ¬ØªÙƒ: ${fillScore}/${fillExercises.length}</div>
    `;
    return;
  }
  const ex=fillExercises[fillIndex];
  const html = ex.sentence.replace('_____',`<input type="text" id="fillAnswer" autocomplete="off" placeholder="...">`);
  box.innerHTML=`
    <div class="fill-sentence">${html}</div>
    <div class="translation-line"><i class="fas fa-language"></i> Ø§Ù„ØªØ±Ø¬Ù…Ø©: ${ex.trans}</div>
    <div class="options-line">Ø§Ù„Ø®ÙŠØ§Ø±Ø§Øª: ${ex.options.map(o=>`<span>${o}</span>`).join(' â€¢ ')}</div>
    <div class="hint-box" id="fillHint">ğŸ’¡ ${ex.hint}</div>
    <div class="inline-audio-group">
      <button class="inline-audio-btn" data-say="${ex.sentence.replace('_____',ex.answer)}"><i class="fas fa-headphones"></i> Ù†Ø·Ù‚</button>
      <button class="inline-audio-btn" data-say="${ex.sentence.replace('_____',ex.answer)}" data-slow="1"><i class="fas fa-turtle"></i> Ø¨Ø·ÙŠØ¡</button>
    </div>
  `;
  el('#fillScoreDisplay').textContent=fillScore;
}

function checkFillAnswer(){
  if(fillIndex>=fillExercises.length) return;
  const ex=fillExercises[fillIndex];
  const input=el('#fillAnswer');
  if(!input) return;
  const val=input.value.trim().toLowerCase();
  if(!val){showFeedback('Ø£Ø¯Ø®Ù„ Ø¥Ø¬Ø§Ø¨Ø©','warning');return;}
  if(val===ex.answer.toLowerCase()){
    input.classList.add('correct');
    if(!input.dataset.scored){
      fillScore++;
      input.dataset.scored="1";
      showFeedback('Ø¥Ø¬Ø§Ø¨Ø© ØµØ­ÙŠØ­Ø© âœ”ï¸','success');
    }
  }else{
    input.classList.add('incorrect');
    showFeedback(`Ø®Ø·Ø£ âŒ Ø§Ù„ØµØ­ÙŠØ­: ${ex.answer}<br><small>${ex.explain}</small>`,'error',5000);
  }
  saveState();
  updateGlobalProgressBar();
}

function nextFill(){
  if(fillIndex<fillExercises.length){
    fillIndex++;
    renderFillExercise();
    saveState();
    updateGlobalProgressBar();
  }
}
function toggleFillHint(){
  const h=el('#fillHint');
  if(h){h.style.display = h.style.display==='block'?'none':'block';}
}
function restartFill(){
  if(!confirm('Ø¥Ø¹Ø§Ø¯Ø© ØªÙ…Ø±ÙŠÙ† Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§ØºØŸ')) return;
  fillIndex=0;fillScore=0;
  renderFillExercise();
  saveState();
  updateGlobalProgressBar();
}

/* ====================== ØªÙ…Ø±ÙŠÙ† Ø§Ù„Ø³Ø­Ø¨ ÙˆØ§Ù„Ø¥ÙÙ„Ø§Øª ====================== */
function initDragDrop(){
  const pool=el('#ddWordPool');
  const zone=el('#ddSentencesZone');
  dragEvaluated=false;
  dragScore=0;
  pool.innerHTML=dragDropData.words.map(w=>`
    <button class="draggable-word" draggable="true" data-word="${w}">${w}</button>
  `).join('');
  zone.innerHTML=dragDropData.sentences.map((s,i)=>`
    <div class="dd-sentence" data-index="${i}">
      <button class="sentence-audio" data-say="${s.tmpl.replace('___',s.ans)}">ğŸ”Š</button>
      ${s.tmpl.replace('___',`<span class="drop-slot" data-ans="${s.ans}">Ø¶Ø¹ Ù‡Ù†Ø§</span>`)}
      <span class="dd-translation"><i class="fas fa-language"></i> ${s.trans}</span>
    </div>
  `).join('');
  el('#dragScoreDisplay').textContent=0;
}

let dragItem=null;
document.addEventListener('dragstart',e=>{
  const word=e.target.closest('.draggable-word');
  if(word){
    dragItem=word;
    e.dataTransfer.setData('text/plain',word.dataset.word);
    setTimeout(()=>word.classList.add('dragging'),10);
  }
});
document.addEventListener('dragend',e=>{
  const word=e.target.closest('.draggable-word');
  if(word) word.classList.remove('dragging');
});
document.addEventListener('dragover',e=>{
  const slot=e.target.closest('.drop-slot');
  if(slot){
    e.preventDefault();
    slot.classList.add('drag-over');
  }
});
document.addEventListener('dragleave',e=>{
  const slot=e.target.closest('.drop-slot');
  if(slot) slot.classList.remove('drag-over');
});
document.addEventListener('drop',e=>{
  const slot=e.target.closest('.drop-slot');
  if(slot){
    e.preventDefault();
    slot.classList.remove('drag-over');
    if(!dragItem) return;
    const val=dragItem.dataset.word;
    if(slot.textContent==='Ø¶Ø¹ Ù‡Ù†Ø§' || !slot.classList.contains('filled')){
      slot.textContent=val;
      slot.classList.add('filled');
      dragItem.remove();
    }
  }
});

function evaluateDragDrop(){
  if(dragEvaluated) return;
  let correct=0;
  els('.drop-slot').forEach(slot=>{
    if(slot.textContent.trim()===slot.dataset.ans){
      slot.classList.add('filled');
      slot.style.background='#c6f6d5';
      slot.style.borderColor='#48bb78';
      correct++;
    }else{
      slot.style.background='#fed7d7';
      slot.style.borderColor='#f56565';
    }
  });
  dragScore=correct;
  dragEvaluated=true;
  el('#dragScoreDisplay').textContent=`${dragScore}/${dragDropData.sentences.length}`;
  showFeedback(`Ù†ØªÙŠØ¬Ø© Ø§Ù„Ø³Ø­Ø¨: ${correct}/${dragDropData.sentences.length}`,(correct===dragDropData.sentences.length)?'success':'warning');
  saveState();
  updateGlobalProgressBar();
}

function speakAllDrag(){
  let i=0;
  const arr=dragDropData.sentences;
  function step(){
    if(i>=arr.length) return;
    speak(arr[i].tmpl.replace('___',arr[i].ans));
    i++;
    setTimeout(step,2500);
  }
  step();
}

/* ====================== Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± ====================== */
function startQuizTimer(){
  if(quizTimerInterval) clearInterval(quizTimerInterval);
  quizTimerInterval=setInterval(()=>{
    quizTimer++;
    const mm=String(Math.floor(quizTimer/60)).padStart(2,'0');
    const ss=String(quizTimer%60).padStart(2,'0');
    el('#quizTimer').textContent=`${mm}:${ss}`;
    saveState();
  },1000);
}
function stopQuizTimer(){
  if(quizTimerInterval){
    clearInterval(quizTimerInterval);
    quizTimerInterval=null;
  }
}
function renderQuizQuestion(){
  el('#quizTotal').textContent=quizQuestions.length;
  if(quizIndex>=quizQuestions.length){
    showQuizResults();
    return;
  }
  const q=quizQuestions[quizIndex];
  el('#quizProgressNum').textContent=quizIndex+1;
  el('#quizQuestionBox').innerHTML=`${q.q}`;
  el('#quizOptionsBox').innerHTML=q.options.map((op,i)=>`
    <div class="quiz-option" data-qopt="${i}" role="button" tabindex="0">${op}</div>
  `).join('');
  el('#quizScoreTemp').textContent=`${quizScore}/${quizQuestions.length}`;
  if(!quizTimerInterval) startQuizTimer();
}
function submitQuizAnswer(){
  if(quizIndex>=quizQuestions.length) return;
  if(quizSelected===null){showFeedback('Ø§Ø®ØªØ± Ø¥Ø¬Ø§Ø¨Ø© Ø£ÙˆÙ„Ø§Ù‹','warning');return;}
  const q=quizQuestions[quizIndex];
  const options=els('.quiz-option');
  options.forEach(o=>{
    const idx=+o.dataset.qopt;
    if(idx===q.ans) o.classList.add('correct');
    else if(idx===quizSelected) o.classList.add('incorrect');
    o.style.pointerEvents='none';
  });
  if(quizSelected===q.ans){
    quizScore++;
    showFeedback('ØµØ­ÙŠØ­ âœ”ï¸','success');
  }else{
    showFeedback('Ø®Ø·Ø£ âŒ ' + q.exp,'error',5000);
  }
  quizSelected=null;
  saveState();
  updateGlobalProgressBar();
  setTimeout(()=>{
    quizIndex++;
    renderQuizQuestion();
  },1400);
}
function showQuizResults(){
  stopQuizTimer();
  const box=el('#quizResultsBox');
  const percent=Math.round((quizScore/quizQuestions.length)*100);
  box.style.display='flex';
  box.innerHTML=`
    <div class="final-score">${percent}%</div>
    <div class="medal-badge">${percent>=80?'ğŸ¥‡':percent>=60?'ğŸ¥ˆ':'ğŸ…'}</div>
    <p style="font-size:.8rem;font-weight:600;color:#4a5568">Ù†ØªÙŠØ¬ØªÙƒ: ${quizScore}/${quizQuestions.length} ÙÙŠ Ù…Ø¯Ø© ${formatTime(quizTimer)}</p>
    <div class="score-breakdown">
      <div class="break-card"><i class="fas fa-clock"></i> Ø§Ù„ÙˆÙ‚Øª: ${formatTime(quizTimer)}</div>
      <div class="break-card"><i class="fas fa-check-circle"></i> ØµØ­ÙŠØ­Ø©: ${quizScore}</div>
      <div class="break-card"><i class="fas fa-times-circle"></i> Ø®Ø§Ø·Ø¦Ø©: ${quizQuestions.length-quizScore}</div>
      <div class="break-card"><i class="fas fa-percentage"></i> Ø§Ù„Ù†Ø³Ø¨Ø©: ${percent}%</div>
    </div>
    <div class="btn-row">
      <button class="big-btn" id="btnQuizAgain"><i class="fas fa-redo"></i> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</button>
      <button class="big-btn blue" data-section-jump="exercise1"><i class="fas fa-book"></i> Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„ØªÙ…Ø§Ø±ÙŠÙ†</button>
    </div>
  `;
  saveState();
  updateGlobalProgressBar();
}

function restartQuiz(full=true){
  if(full && !confirm('Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ø§Ù„Ø¨Ø¯Ø§ÙŠØ©ØŸ')) return;
  quizIndex=0;
  quizScore=0;
  quizSelected=null;
  quizTimer=0;
  el('#quizResultsBox').style.display='none';
  renderQuizQuestion();
  saveState();
  updateGlobalProgressBar();
  startQuizTimer();
}

function formatTime(sec){
  const m=String(Math.floor(sec/60)).padStart(2,'0');
  const s=String(sec%60).padStart(2,'0');
  return `${m}:${s}`;
}

/* ====================== Ø§Ù„ØªÙ†Ù‚Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ====================== */
function setSection(id){
  currentSection=id;
  els('.section').forEach(sec=>sec.classList.toggle('active',sec.id===id));
  els('.nav-btn').forEach(btn=>btn.classList.toggle('active',btn.dataset.section===id));
  saveState();
  if(id==='quiz'){ renderQuizQuestion(); }
  if(id==='pronunciation'){ renderPronunciation(); }
  if(id==='exercise1'){ renderFillExercise(); }
  if(id==='exercise2'){ initDragDrop(); }
  if(id==='vocabulary'){ renderVocabulary(); }
  if(id==='phrases'){ renderPhrases(); }
  updateGlobalProgressBar();
}

/* ====================== Ø§Ù„ØªÙ‡ÙŠØ¦Ø© Ø§Ù„Ø£ÙˆÙ„Ù‰ ====================== */
function renderAllSections(skipFocus){
  renderVocabulary();
  renderPhrases();
  renderPronunciation();
  renderFillExercise();
  initDragDrop();
  renderQuizQuestion();
  updateGlobalProgressBar();
  if(!skipFocus){
    const activeSec=el('.section.active');
    if(activeSec) activeSec.focus();
  }
}

function initSessionTimer(){
  if(sessionTimerInterval) clearInterval(sessionTimerInterval);
  sessionTimerInterval=setInterval(()=>{
    sessionSeconds++;
    const mm=String(Math.floor(sessionSeconds/60)).padStart(2,'0');
    const ss=String(sessionSeconds%60).padStart(2,'0');
    el('#sessionTimer').textContent=`${mm}:${ss}`;
  },1000);
}

/* ====================== Ø§Ù„Ø£Ø­Ø¯Ø§Ø« (ØªÙÙˆÙŠØ¶) ====================== */
document.addEventListener('click',e=>{
  const nav=e.target.closest('.nav-btn');
  if(nav){
    setSection(nav.dataset.section);
  }

  const vcat=e.target.closest('.filter-btn[data-vcat]');
  if(vcat){
    vocabCategory=vcat.dataset.vcat;
    renderVocabulary();
    saveState();
  }

  const pcat=e.target.closest('.filter-btn[data-pcat]');
  if(pcat){
    phraseCategory=pcat.dataset.pcat;
    renderPhrases();
    saveState();
  }

  const mode=e.target.closest('.mode-btn');
  if(mode){
    pronMode=mode.dataset.pmode;
    pronIndex=0;
    renderPronunciation();
    saveState();
  }

  const flipBtn=e.target.closest('[data-flip]');
  if(flipBtn){
    const term=flipBtn.dataset.flip;
    const card=e.target.closest('.vocab-card');
    if(card) card.classList.toggle('flipped');
  }

  const speakBtn=e.target.closest('[data-say]');
  if(speakBtn){
    const txt = speakBtn.dataset.say;
    const lang= speakBtn.dataset.lang || 'fr-FR';
    const slow= !!speakBtn.dataset.slow;
    speak(txt,lang,speakBtn,slow);
  }

  if(e.target.id==='btnPronPlay'){
    const data=pronunciationData[pronMode];
    if(data && data[pronIndex]) speak(data[pronIndex].fr,'fr-FR',e.target);
  }
  if(e.target.id==='btnPronSlow'){
    const data=pronunciationData[pronMode];
    if(data && data[pronIndex]) speak(data[pronIndex].fr,'fr-FR',e.target,true);
  }
  if(e.target.id==='btnPronNext'){
    const data=pronunciationData[pronMode];
    if(!data) return;
    pronIndex++;
    if(pronIndex>=data.length){
      pronIndex=0;
      pronCounters[pronMode]=Math.min(pronCounters[pronMode]+data.length,data.length);
      showFeedback('ØªÙ… Ø§Ø³ØªØ¹Ø±Ø§Ø¶ Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± Ù‡Ø°Ø§ Ø§Ù„Ù‚Ø³Ù…','info');
    }else{
      pronCounters[pronMode]=Math.min(pronCounters[pronMode]+1,data.length);
    }
    renderPronunciation();
    saveState();
    updateGlobalProgressBar();
  }
  if(e.target.id==='btnPronRestart'){
    pronIndex=0;
    pronCounters[pronMode]=0;
    renderPronunciation();
    saveState();
    updateGlobalProgressBar();
  }

  // Ø§Ù…Ù„Ø£ Ø§Ù„ÙØ±Ø§Øº
  if(e.target.id==='btnFillCheck') checkFillAnswer();
  if(e.target.id==='btnFillNext') nextFill();
  if(e.target.id==='btnFillHint') toggleFillHint();
  if(e.target.id==='btnFillRestart') restartFill();

  // Ø³Ø­Ø¨ ÙˆØ¥ÙÙ„Ø§Øª
  if(e.target.id==='btnDDCheck') evaluateDragDrop();
  if(e.target.id==='btnDDReset'){ initDragDrop(); saveState(); updateGlobalProgressBar(); }
  if(e.target.id==='btnDDSpeak') speakAllDrag();

  // Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±
  if(e.target.id==='btnQuizSubmit') submitQuizAnswer();
  if(e.target.id==='btnQuizSpeak'){
    if(quizIndex<quizQuestions.length){
      speak(quizQuestions[quizIndex].q,'ar-SA',e.target);
    }
  }
  if(e.target.id==='btnQuizRestart') restartQuiz(true);
  if(e.target.id==='btnQuizAgain') restartQuiz(true);
  if(e.target.dataset.sectionJump){
    setSection(e.target.dataset.sectionJump);
  }

  if(e.target.id==='btnResetAll') resetAllProgress();
});

document.addEventListener('keydown',e=>{
  if(e.key==='Enter'){
    if(currentSection==='exercise1') checkFillAnswer();
    if(currentSection==='quiz') submitQuizAnswer();
  }
});

document.addEventListener('click',e=>{
  const opt=e.target.closest('.quiz-option');
  if(opt){
    if(opt.classList.contains('correct')||opt.classList.contains('incorrect')) return;
    els('.quiz-option').forEach(o=>o.classList.remove('selected'));
    opt.classList.add('selected');
    quizSelected=+opt.dataset.qopt;
  }
});

/* ====================== Ø¨Ø­Ø« Ø§Ù„Ù…ÙØ±Ø¯Ø§Øª ====================== */
el('#vocabSearch').addEventListener('input',()=>{
  renderVocabulary();
});

/* ====================== Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„ ====================== */
function initApp(){
  loadState();
  el('#todayDate').textContent=new Date().toLocaleDateString('ar-EG',{weekday:'long',year:'numeric',month:'long',day:'numeric'});
  renderAllSections(true);
  initSessionTimer();
  if(savedStateLoaded){
    showFeedback('ØªÙ… ØªØ­Ù…ÙŠÙ„ ØªÙ‚Ø¯Ù…Ùƒ Ø§Ù„Ø³Ø§Ø¨Ù‚','success',2500);
  }else{
    showFeedback('Ù…Ø±Ø­Ø¨Ø§Ù‹! Ø§Ø¨Ø¯Ø£ Ø±Ø­Ù„ØªÙƒ Ø§Ù„Ø¢Ù†','info',2500);
  }
  updateGlobalProgressBar();
}

window.addEventListener('beforeunload',saveState);
window.addEventListener('error',err=>{
  console.error(err);
  showFeedback('Ø®Ø·Ø£ ØºÙŠØ± Ù…ØªÙˆÙ‚Ø¹: '+err.message,'error',5000);
});

initApp();
</script>
</body>
</html>